"use strict";const e=require("../../common/vendor.js"),o=require("../../api/apis.js");Math||n();const n=()=>"../../components/VerificationCode.js",a=e.defineComponent({__name:"reg",setup(n){const a=()=>{e.index.navigateBack()},t=()=>{u.value=!u.value},i=e.ref(""),s=e.ref(""),l=e.ref(null),c=e.ref(""),d=e.ref(""),u=e.ref(!1),r=e.reactive({account:"",code:"",uname:"",password:""}),v=e=>{s.value=e},h=async()=>{if(i.value)try{const n=await o.apiSendCode({phone:i.value});200===n.code?l.value.startCountdown():e.index.showToast({title:n.errMsg,icon:"none"})}catch(n){e.index.showToast({title:"发送验证码失败",icon:"none"})}else e.index.showToast({title:"请输入手机号",icon:"none"})};e.watch([i,s,c,d],(([e,o,n,a])=>{r.account=e,r.code=o,r.uname=n,r.password=a}),{immediate:!0});const w=async()=>{if(i.value)if(s.value)if(c.value)if(d.value){e.index.showLoading({title:"注册中..."});try{const n=await o.apiRegInfo(r);e.index.hideLoading(),n?(e.index.showToast({title:"注册成功",icon:"success"}),setTimeout((()=>{e.index.redirectTo({url:"/pages/login/login"})}),1500)):e.index.showModal({title:"注册失败",content:"注册失败，请重试",showCancel:!1})}catch(n){e.index.hideLoading(),e.index.showModal({title:"注册失败",content:"网络错误，请检查网络连接后重试",showCancel:!1})}}else e.index.showToast({title:"请输入密码",icon:"none"});else e.index.showToast({title:"请输入用户名",icon:"none"});else e.index.showToast({title:"请输入验证码",icon:"none"});else e.index.showToast({title:"请输入手机号",icon:"none"})};return(o,n)=>({a:e.o(a),b:i.value,c:e.o((e=>i.value=e.detail.value)),d:e.sr(l,"31c67a93-0",{k:"codeRef"}),e:e.o(h),f:e.o(v),g:e.p({placeholder:"请输入验证码"}),h:c.value,i:e.o((e=>c.value=e.detail.value)),j:u.value?"text":"password",k:d.value,l:e.o((e=>d.value=e.detail.value)),m:u.value?1:"",n:e.o(t),o:e.o(a),p:e.o(w),q:e.o(w)})}}),t=e._export_sfc(a,[["__scopeId","data-v-31c67a93"]]);wx.createPage(t);
