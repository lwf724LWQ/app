"use strict";const e=require("../../../common/vendor.js"),a=require("../../../api/apis.js"),u=require("./useFunc/useTableData.js");if(!Array){e.resolveComponent("uni-icons")()}Math;const o={__name:"drawLineRead",setup(o){const t=e.ref([]);function n(e){return e&&"string"==typeof e?e.trim().split(/\s+/).filter((e=>""!==e)).map((e=>Number(e))).slice(0,5):[]}const r=e.ref(!1),s={page:1,limit:20,tname:"排列五"},l=e.ref(""),i=e.computed((()=>t.value.map((e=>({qishu:e.qishu,numbers:[e.qishu2,...e.numbers]})))));console.log(i);const c=u.useTableData();e.watch(i,(a=>{console.log("formattedClassifyList 发生变化:",a),a&&a.length>0&&e.nextTick$1((()=>{c&&"function"==typeof c.updateNumberGroups?(console.log("调用 updateNumberGroups"),c.updateNumberGroups(a)):console.error("updateNumberGroups 函数不存在")}))}),{deep:!0,immediate:!0}),e.onLoad((e=>{let{name:a=null}=e;a&&(s.tname=a),l.value=a,p()})),e.onPullDownRefresh((()=>{console.log("onPullDownRefresh"),r.value||(s.page++,p())}));const p=async()=>{e.index.showLoading({title:"加载中...",mask:!0});let u=await a.apiTicketQuery(s),o=(u.data.records.map((e=>{return{...e,qishu:Number(e.issueno),qishu2:(a=n(e.number),!Array.isArray(a)||a.length<4?0:a.slice(0,4).filter((e=>!isNaN(e)&&"number"==typeof e)).reduce(((e,a)=>e+a),0)),numbers:n(e.number)};var a}))||[]).sort(((e,a)=>Number(e.issueno)-Number(a.issueno)));console.log(t.value,"-----------------------------------------"),t.value=[...o,...t.value],await e.nextTick$1(),console.log(t.value,"//这里是从网库中获取的数据"),s.limit>u.data.length&&(r.value=!0),e.index.hideLoading(),e.index.stopPullDownRefresh(),c.updateNumberGroups(i.value),c&&"function"==typeof c.updateNumberGroups?c.updateNumberGroups(i.value):console.error("updateNumberGroups 函数不存在"),c&&"function"==typeof c.updateNumberGroups&&(await e.nextTick$1(),c.updateNumberGroups(i.value))};e.onUnload((()=>{}));const d=e.ref(!1),m=()=>{e.index.navigateBack({delta:1})},v=()=>{d.value=!d.value},f=()=>{d.value=!1};e.watch(t,(e=>{c&&"function"==typeof c.updateNumberGroups&&c.updateNumberGroups(i.value)}),{deep:!0});const g=e.ref(!1),b=e.ref(!1);return e.onReachBottom((()=>{g.value||b.value||(g.value=!0,++s.page,p().then((()=>{t.value.length%s.limit!=0&&(b.value=!0)})).catch((e=>{console.error("加载更多数据失败:",e),s.page--})).finally((()=>{g.value=!1})))})),(a,u)=>e.e({a:e.p({type:"left",size:"30"}),b:e.o(m),c:e.o(v),d:e.p({type:"color-filled",size:"30"}),e:e.o((a=>(a=>{if(f(),"draw"===a){const a=[...t.value.slice(-50),...Array.from({length:4},(()=>({qishu:"",qishu2:"",numbers:["","","","",""]})))];e.index.setStorageSync("drawLineData",a),e.index.navigateTo({url:"/pages/juWang/drawLine/drawLine?name=排列5",events:{acceptDataFromOpenedPage:function(e){console.log(e)},someEvent:function(e){console.log(e)}},success:function(e){e.eventChannel.emit("acceptDataFromOpenerPage",{data:"data from starter page"})}})}})("draw"))),f:d.value?1:"",g:e.o((()=>{})),h:d.value},d.value?{i:e.o(f)}:{},{j:e.f(t.value,((a,u,o)=>({a:e.t(a.qishu),b:e.t(a.qishu2),c:e.f(a.numbers,((a,u,o)=>({a:e.t(a),b:u,c:u,d:e.n("col-"+(3+u))}))),d:u,e:a.qishu,f:a.qishu,g:u}))),k:g.value},(g.value,{}),{l:b.value&&!g.value},(b.value&&g.value,{}))}},t=e._export_sfc(o,[["__scopeId","data-v-b00dc459"]]);wx.createPage(t);
