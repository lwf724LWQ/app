"use strict";const e=require("../common/vendor.js"),t=require("../api/apis.js");exports.client=null;let s=!1;exports.initOSS=async function(){if(s)return new Promise((e=>{const t=setInterval((()=>{exports.client&&(clearInterval(t),e(exports.client))}),100)}));s=!0;try{const c=await t.apigetsts();return console.log("STS获取成功:",c),exports.client=new e.OSS({accessKeyId:c.data.STSaccessKeyId,accessKeySecret:c.data.STSsecretAccessKey,stsToken:c.data.security_token,bucket:"cjvd",region:"oss-cn-guangzhou"}),console.log("OSS客户端初始化成功"),s=!1,exports.client}catch(c){throw console.error("OSS客户端初始化失败:",c),s=!1,c}};
