import{r as e,C as a,w as s,h as l,D as u,i as t,E as o,G as n,x as r,e as c,b as i,c as d,g as p,F as m,u as f,o as b,H as v,f as g,n as h,J as _,y,z as N,q as w,k as q,p as k,t as G}from"./index-BgH6xnyV.js";import{_ as x}from"./uni-icons.C97tYrvo.js";import{o as C,a as j,b as D,c as L,r as z}from"./uni-app.es.wmAOsoD-.js";import{c as A}from"./apis.BPdXt_sA.js";import{u as F}from"./useTableData.DnZSif1c.js";import{_ as P}from"./_plugin-vue_export-helper.BCo6x5W8.js";const R=P({__name:"drawLineRead",setup(P){const R=e([]);function E(e){return e&&"string"==typeof e?e.trim().split(/\s+/).filter((e=>""!==e)).map((e=>Number(e))).slice(0,5):[]}const O=e(!1),H={page:1,limit:20,tname:"排列五"},I=e(""),J=a((()=>R.value.map((e=>({qishu:e.qishu,numbers:[e.qishu2,...e.numbers]})))));console.log(J);const T=F();s(J,(e=>{console.log("formattedClassifyList 发生变化:",e),e&&e.length>0&&u((()=>{T&&"function"==typeof T.updateNumberGroups?(console.log("调用 updateNumberGroups"),T.updateNumberGroups(e)):console.error("updateNumberGroups 函数不存在")}))}),{deep:!0,immediate:!0}),C((e=>{let{name:a=null}=e;a&&(H.tname=a),I.value=a,W()})),j((()=>{console.log("onPullDownRefresh"),O.value||(H.page++,W())}));const W=async()=>{l({title:"加载中...",mask:!0});let e=await A(H),a=(e.data.records.map((e=>{return{...e,qishu:Number(e.issueno),qishu2:(a=E(e.number),!Array.isArray(a)||a.length<4?0:a.slice(0,4).filter((e=>!isNaN(e)&&"number"==typeof e)).reduce(((e,a)=>e+a),0)),numbers:E(e.number)};var a}))||[]).sort(((e,a)=>Number(e.issueno)-Number(a.issueno)));console.log(R.value,"-----------------------------------------"),R.value=[...a,...R.value],await u(),console.log(R.value,"//这里是从网库中获取的数据"),H.limit>e.data.length&&(O.value=!0),t(),o(),T.updateNumberGroups(J.value),T&&"function"==typeof T.updateNumberGroups?T.updateNumberGroups(J.value):console.error("updateNumberGroups 函数不存在"),T&&"function"==typeof T.updateNumberGroups&&(await u(),T.updateNumberGroups(J.value))};D((()=>{}));const B=e(!1),K=()=>{w({delta:1})},M=()=>{B.value=!B.value},Q=()=>{B.value=!1};s(R,(e=>{T&&"function"==typeof T.updateNumberGroups&&T.updateNumberGroups(J.value)}),{deep:!0});const S=e(!1),U=e(!1);return L((()=>{S.value||U.value||(S.value=!0,++H.page,W().then((()=>{R.value.length%H.limit!=0&&(U.value=!0)})).catch((e=>{console.error("加载更多数据失败:",e),H.page--})).finally((()=>{S.value=!1})))})),(e,a)=>{const s=z(n("uni-icons"),x),l=f,u=G;return b(),r(m,null,[c(l,{class:"container"},{default:i((()=>[c(l,{class:"navbar"},{default:i((()=>[c(l,{class:"navbar-left",onClick:K},{default:i((()=>[c(s,{type:"left",size:"30"})])),_:1}),c(l,{class:"navbar-title"}),c(l,{class:"navbar-right",onClick:v(M,["stop"])},{default:i((()=>[c(u,{class:"menu-icon"},{default:i((()=>[g("⋮")])),_:1})])),_:1})])),_:1}),c(l,{class:h(["popover",{show:B.value}]),onClick:a[1]||(a[1]=v((()=>{}),["stop"]))},{default:i((()=>[c(l,{class:"popover-content"},{default:i((()=>[c(l,{class:"menu-item",onClick:a[0]||(a[0]=e=>(e=>{if(Q(),"draw"===e){const e=[...R.value.slice(-50),...Array.from({length:4},(()=>({qishu:"",qishu2:"",numbers:["","","","",""]})))];q("drawLineData",e),k({url:"/pages/juWang/drawLine/drawLine?name=排列5",events:{acceptDataFromOpenedPage:function(e){console.log(e)},someEvent:function(e){console.log(e)}},success:function(e){e.eventChannel.emit("acceptDataFromOpenerPage",{data:"data from starter page"})}})}})("draw"))},{default:i((()=>[c(s,{type:"color-filled",size:"30"}),c(u,{class:"menu-text"},{default:i((()=>[g("去画规")])),_:1})])),_:1})])),_:1})])),_:1},8,["class"]),B.value?(b(),d(l,{key:0,class:"mask",onClick:Q})):p("",!0),c(l,{class:"numbers-table-container"},{default:i((()=>[_("table",{class:"numbers-table"},[_("colgroup",null,[_("col",{class:"col-def-1"}),_("col",{class:"col-def-2"}),_("col",{class:"col-def-3"}),_("col",{class:"col-def-4"}),_("col",{class:"col-def-5"}),_("col",{class:"col-def-6"}),_("col",{class:"col-def-7"})]),_("tbody",null,[(b(!0),r(m,null,y(R.value,((e,a)=>(b(),r("tr",{key:e.qishu,class:"table-row","data-qishu":e.qishu,"data-group-index":a},[_("td",{class:"table-cell col-1 non-drawable-area"},[c(l,{class:"cell-content"},{default:i((()=>[g(N(e.qishu),1)])),_:2},1024)]),_("td",{class:"table-cell col-2"},[c(l,{class:"cell-content"},{default:i((()=>[g(N(e.qishu2),1)])),_:2},1024)]),(b(!0),r(m,null,y(e.numbers,((e,s)=>(b(),r("td",{key:s,class:h(["table-cell","col-"+(3+s)])},[c(l,{class:"number-item","data-group-index":a,"data-num-index":s,ref_for:!0,ref:"numberRefs"},{default:i((()=>[g(N(e),1)])),_:2},1032,["data-group-index","data-num-index"])],2)))),128))],8,["data-qishu","data-group-index"])))),128))])])])),_:1})])),_:1}),S.value?(b(),d(l,{key:0,class:"loading-container"},{default:i((()=>[c(l,{class:"loading-spinner"}),c(u,null,{default:i((()=>[g("加载中...")])),_:1})])),_:1})):p("",!0),U.value&&!S.value?(b(),d(l,{key:1,class:"no-more-data"},{default:i((()=>[c(u,null,{default:i((()=>[g("没有更多数据了")])),_:1})])),_:1})):p("",!0)],64)}}},[["__scopeId","data-v-b00dc459"]]);export{R as default};
