{"version":3,"file":"pattern-predict.js","sources":["pages/pattern-predict/pattern-predict.vue","D:/uniapp/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvcGF0dGVybi1wcmVkaWN0L3BhdHRlcm4tcHJlZGljdC52dWU"],"sourcesContent":["<template>\n  <view class=\"pattern-predict-container\">\n    <!-- 导航栏 -->\n    <view class=\"nav-bar\">\n      <view class=\"nav-left\" @click=\"goBack\">\n        <uni-icons type=\"left\" size=\"20\" color=\"#333\"></uni-icons>\n      </view>\n      <view class=\"nav-title\">规律预测</view>\n      <view class=\"nav-right\"></view>\n    </view>\n    \n    <!-- 主要内容 -->\n    <view class=\"main-content\">\n      <!-- 我的方案区域 -->\n      <view class=\"scheme-section\">\n        <view class=\"section-title\">我的方案 (必选)</view>\n        <view class=\"scheme-input\" @click=\"goToSchemePage\">\n          <view class=\"issue-info\">\n            <text class=\"issue-number\">第{{ issueNumber }}期</text>\n          </view>\n          <!-- 显示已设置的方案 -->\n          <view v-if=\"schemes.length > 0\" class=\"scheme-display\">\n            <view class=\"scheme-content\">\n              <!-- 期号显示 -->\n              <text class=\"issue-number\">第{{ issueNumber }}期</text>\n              \n              <!-- 方案详情 -->\n              <view \n                v-for=\"(scheme, index) in schemes\" \n                :key=\"index\" \n                class=\"scheme-item\"\n              >\n                <text class=\"scheme-name\">[{{ scheme.id }}]</text>\n                <view class=\"scheme-details\">\n                  <text \n                    v-for=\"(detail, detailIndex) in getSchemeDisplayData(scheme)\" \n                    :key=\"detailIndex\" \n                    class=\"scheme-detail\"\n                  >\n                    {{ detail }}\n                  </text>\n                </view>\n              </view>\n            </view>\n          </view>\n          <!-- 未设置方案时的提示 -->\n          <view v-else class=\"scheme-placeholder\">\n            <text class=\"placeholder-text\">还没有添加方案噢,点击可添加方案 ></text>\n          </view>\n        </view>\n      </view>\n      \n      <!-- 添加规律图片区域 -->\n      <view class=\"image-section\">\n        <view class=\"section-title\">添加规律图片 (必选，最多6张)</view>\n        <view class=\"image-upload-container\">\n          <!-- 已选择的图片 -->\n          <view v-if=\"selectedImages.length > 0\" class=\"selected-images\">\n            <view \n              v-for=\"(image, index) in selectedImages\" \n              :key=\"index\" \n              class=\"image-item\"\n            >\n              <image :src=\"image\" class=\"uploaded-image\" mode=\"aspectFit\"></image>\n              <view class=\"image-delete\" @click=\"removeImage(index)\">\n                <uni-icons type=\"close\" size=\"16\" color=\"#fff\"></uni-icons>\n              </view>\n            </view>\n          </view>\n          \n          <!-- 添加图片按钮 -->\n          <view \n            v-if=\"selectedImages.length < 6\" \n            class=\"add-image-btn\" \n            @click=\"selectImage\"\n          >\n            <uni-icons type=\"camera\" size=\"40\" color=\"#ccc\"></uni-icons>\n            <text class=\"add-text\">添加图片</text>\n            <text class=\"count-text\">{{ selectedImages.length }}/6</text>\n          </view>\n        </view>\n      </view>\n      \n      <!-- 免责声明 -->\n      <view class=\"disclaimer\">\n        <text class=\"disclaimer-text\">注: 帖子一旦发布, 将不能进行修改或删除操作</text>\n      </view>\n      \n      <!-- 底部按钮区域 -->\n      <view class=\"bottom-buttons\">\n        <button class=\"modify-btn\" @click=\"goToSchemePage\">修改</button>\n        <button class=\"publish-btn\" :class=\"{ disabled: !canPublish }\" @click=\"handlePublish\">\n          发布\n        </button>\n      </view>\n      \n      \n    </view>\n  </view>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted } from 'vue'\nimport { onShow } from '@dcloudio/uni-app'\nimport { apiGetIssueNo, apiPost, getCOSSecretKey } from '@/api/apis.js'\nimport { getAccount } from '@/utils/request.js'\n\n// 响应式数据\nconst issueNumber = ref('')\nconst selectedImages = ref([]) // 改为数组支持多张图片\nconst schemes = ref([])\nconst lotteryType = ref(null)\nconst uploadedImageUrls = ref([]) // 改为数组存储多张图片URL\nconst isUploadingImage = ref(false)\n\n// 计算属性\nconst canPublish = computed(() => {\n  return schemes.value.length > 0 && selectedImages.value.length > 0\n})\n\n// 页面加载时获取期号\nonMounted(() => {\n  loadIssueInfo()\n  loadSchemesFromStorage()\n})\n\n// 页面显示时重新加载方案数据\nonShow(() => {\n  loadSchemesFromStorage()\n})\n\n// OSS上传函数，和edit-profile.vue相同的方法\nconst uploadObject = async (file, callback) => {\n  try {\n    let fileName = file.name || ''\n    const origin_file_name = fileName.split(\".\").slice(0, fileName.split(\".\").length - 1).join('.') // 获取文件名\n    \n    // 获取当前时间戳\n    const upload_file_name = new Date().getTime() + '.' + fileName.split(\".\")[fileName.split(\".\").length - 1]\n    \n    // 请求接口得到token\n    let res = await getCOSSecretKey({})\n    \n    if (res.code !== 200) {\n      throw new Error('获取上传凭证失败')\n    }\n    \n    // 动态导入ali-oss\n    const OSS = await import('ali-oss')\n    \n    // 根据STS接口实际返回的数据结构创建OSS客户端\n    const ossConfig = {\n      region: res.data.region || 'cn-guangzhou',\n      accessKeyId: res.data.STSaccessKeyId,\n      accessKeySecret: res.data.STSsecretAccessKey,\n      stsToken: res.data.security_token,\n      bucket: res.data.bucket || 'cjvd',\n      // 使用正确的endpoint\n      endpoint: 'https://oss-cn-guangzhou.aliyuncs.com',\n      // 添加STS token刷新机制\n      refreshSTSToken: async () => {\n        const newRes = await getCOSSecretKey({})\n        return {\n          accessKeyId: newRes.data.STSaccessKeyId,\n          accessKeySecret: newRes.data.STSsecretAccessKey,\n          stsToken: newRes.data.security_token\n        }\n      },\n      refreshSTSTokenInterval: 300000 // 5分钟刷新一次\n    }\n    \n    const client = new OSS.default(ossConfig)\n    \n    // 上传文件\n    const result = await client.put(`himg/${upload_file_name}`, file)\n    \n    if (result && result.url) {\n      // 直接使用固定的自定义域名前缀 + 唯一文件名\n      const customUrl = `http://video.caimizm.com/himg/${upload_file_name}`\n      \n      callback(customUrl)\n    } else {\n      throw new Error('上传失败')\n    }\n    \n  } catch (error) {\n    throw error\n  }\n}\n\n// 获取分行显示的方案数据\nconst getSchemeDisplayData = (scheme) => {\n  const data = scheme.data\n  const result = []\n  \n  if (scheme.id === '二字现' || scheme.id === '三字现') {\n    // 组合类方案\n    if (data.combinations && data.combinations.length > 0) {\n      result.push(`组合: ${data.combinations.join(',')}`)\n    } else {\n      result.push('组合: 未选择')\n    }\n  } else {\n    // 数字类方案 - 按照图片格式显示\n    if (data.thousands && data.thousands.length > 0) {\n      let thousandsInfo = `千位: ${data.thousands.join('')}`\n      if (data.thousandsMainAttack && data.thousandsMainAttack.length > 0) {\n        thousandsInfo += ` 主攻${data.thousandsMainAttack.join('')}`\n      }\n      if (data.thousandsKeyPoint && data.thousandsKeyPoint.length > 0) {\n        thousandsInfo += ` 重点${data.thousandsKeyPoint.join('')}`\n      }\n      result.push(thousandsInfo)\n    }\n    \n    if (data.hundreds && data.hundreds.length > 0) {\n      let hundredsInfo = `百位: ${data.hundreds.join('')}`\n      if (data.hundredsMainAttack && data.hundredsMainAttack.length > 0) {\n        hundredsInfo += ` 主攻${data.hundredsMainAttack.join('')}`\n      }\n      if (data.hundredsKeyPoint && data.hundredsKeyPoint.length > 0) {\n        hundredsInfo += ` 重点${data.hundredsKeyPoint.join('')}`\n      }\n      result.push(hundredsInfo)\n    }\n    \n    if (data.tens && data.tens.length > 0) {\n      let tensInfo = `十位: ${data.tens.join('')}`\n      if (data.tensMainAttack && data.tensMainAttack.length > 0) {\n        tensInfo += ` 主攻${data.tensMainAttack.join('')}`\n      }\n      if (data.tensKeyPoint && data.tensKeyPoint.length > 0) {\n        tensInfo += ` 重点${data.tensKeyPoint.join('')}`\n      }\n      result.push(tensInfo)\n    }\n    \n    if (data.units && data.units.length > 0) {\n      let unitsInfo = `个位: ${data.units.join('')}`\n      if (data.unitsMainAttack && data.unitsMainAttack.length > 0) {\n        unitsInfo += ` 主攻${data.unitsMainAttack.join('')}`\n      }\n      if (data.unitsKeyPoint && data.unitsKeyPoint.length > 0) {\n        unitsInfo += ` 重点${data.unitsKeyPoint.join('')}`\n      }\n      result.push(unitsInfo)\n    }\n    \n    if (result.length === 0) {\n      result.push('未选择')\n    }\n  }\n  \n  return result\n}\n\n// 从本地存储加载方案数据\nconst loadSchemesFromStorage = () => {\n  try {\n    const savedData = uni.getStorageSync('predict_schemes_data')\n    if (savedData && savedData.addedSchemes && Array.isArray(savedData.addedSchemes)) {\n      schemes.value = savedData.addedSchemes\n    } else {\n      schemes.value = []\n    }\n  } catch (error) {\n    schemes.value = []\n  }\n}\n\n// 加载期号信息\nconst loadIssueInfo = async () => {\n  try {\n    // 从本地存储获取当前彩票类型\n    const savedLotteryType = uni.getStorageSync('currentLotteryType')\n    if (savedLotteryType) {\n      lotteryType.value = savedLotteryType\n    } else {\n      // 默认使用排列三\n      lotteryType.value = { id: 16, code: 16, name: '排列三' }\n    }\n    \n    if (!lotteryType.value || !lotteryType.value.id) {\n      return\n    }\n    \n    uni.showLoading({ title: '加载期号中...' })\n    \n    const response = await apiGetIssueNo({ cpid: lotteryType.value.id })\n    \n    uni.hideLoading()\n    \n    if (response.code === 200 && response.data !== null && response.data !== undefined) {\n      let issueNumberValue = null\n      let issueStatus = '待开奖'\n      let issueTime = '今天 21:30'\n      \n      if (typeof response.data === 'number' || typeof response.data === 'string') {\n        issueNumberValue = response.data.toString()\n      } else if (typeof response.data === 'object') {\n        issueNumberValue = response.data.issueno || response.data.number || response.data.id\n        issueStatus = response.data.status || '待开奖'\n        issueTime = response.data.time || '今天 21:30'\n      }\n      \n      // 直接使用获取到的期号，即使是0也使用\n      issueNumber.value = issueNumberValue || '0'\n      uni.showToast({ title: `期号加载成功: ${issueNumber.value}`, icon: 'success' })\n    } else {\n      // 如果接口失败，使用0作为默认期号\n      issueNumber.value = '0'\n      uni.showToast({ title: '使用默认期号: 0', icon: 'none' })\n    }\n  } catch (error) {\n    uni.hideLoading()\n    // 如果加载失败，也使用0作为期号\n    issueNumber.value = '0'\n    uni.showToast({ title: '期号加载异常，使用默认期号: 0', icon: 'none' })\n  }\n}\n\n// 返回上一页\nconst goBack = () => {\n  uni.navigateBack()\n}\n\n// 跳转到方案页面\nconst goToSchemePage = () => {\n  console.log('=== 规律帖跳转到方案页面 ===')\n  console.log('当前页面:', 'pages/pattern-predict/pattern-predict')\n  \n  // 准备传递的数据\n  const publishData = {\n    lotteryType: lotteryType.value,\n    issueInfo: {\n      id: issueNumber.value,\n      number: issueNumber.value,\n      status: '待开奖',\n      time: '今天 21:30'\n    },\n    schemes: schemes.value\n  }\n  \n  uni.navigateTo({\n    url: `/pages/predict-scheme/predict-scheme?data=${encodeURIComponent(JSON.stringify(publishData))}`,\n    success: () => {\n      // 跳转成功\n    },\n    fail: (err) => {\n      uni.showToast({\n        title: '跳转失败',\n        icon: 'none'\n      })\n    }\n  })\n}\n\n// 选择图片\nconst selectImage = async () => {\n  if (isUploadingImage.value) {\n    uni.showToast({\n      title: '图片正在上传中，请稍候',\n      icon: 'none'\n    })\n    return\n  }\n\n  // 计算还能选择多少张图片\n  const remainingCount = 6 - selectedImages.value.length\n  if (remainingCount <= 0) {\n    uni.showToast({\n      title: '最多只能选择6张图片',\n      icon: 'none'\n    })\n    return\n  }\n\n  try {\n    // 选择图片\n    const chooseResult = await uni.chooseImage({\n      count: remainingCount, // 最多选择剩余数量\n      sizeType: ['compressed'],\n      sourceType: ['album', 'camera']\n    })\n    \n    if (chooseResult.tempFilePaths && chooseResult.tempFilePaths.length > 0) {\n      // 显示上传进度\n      uni.showLoading({\n        title: '上传图片中...'\n      })\n      \n      isUploadingImage.value = true\n      \n      // 批量上传图片\n      const uploadPromises = chooseResult.tempFilePaths.map(async (tempFilePath, index) => {\n        try {\n          // 在H5环境中，需要将临时路径转换为File对象\n          let fileToUpload\n          if (process.env.NODE_ENV === 'development' || typeof window !== 'undefined') {\n            // H5环境\n            const response = await fetch(tempFilePath)\n            const blob = await response.blob()\n            fileToUpload = new File([blob], `pattern-image-${index}.jpg`, { type: 'image/jpeg' })\n          } else {\n            // 小程序环境\n            fileToUpload = tempFilePath\n          }\n          \n          // 上传到OSS\n          return new Promise((resolve, reject) => {\n            uploadObject(fileToUpload, (url) => {\n              resolve({ tempFilePath, url })\n            })\n          })\n        } catch (error) {\n          throw error\n        }\n      })\n      \n      // 等待所有图片上传完成\n      const uploadResults = await Promise.all(uploadPromises)\n      \n      // 更新图片列表\n      uploadResults.forEach(({ tempFilePath, url }) => {\n        selectedImages.value.push(tempFilePath)\n        uploadedImageUrls.value.push(url)\n      })\n      \n      uni.hideLoading()\n      uni.showToast({\n        title: `成功上传${uploadResults.length}张图片`,\n        icon: 'success'\n      })\n      \n      isUploadingImage.value = false\n    }\n  } catch (error) {\n    uni.hideLoading()\n    isUploadingImage.value = false\n    uni.showToast({\n      title: '图片上传失败',\n      icon: 'none'\n    })\n  }\n}\n\n// 删除图片\nconst removeImage = (index) => {\n  selectedImages.value.splice(index, 1)\n  uploadedImageUrls.value.splice(index, 1)\n}\n\n// 生成帖子内容\nconst generatePostContent = () => {\n  let content = '【规律预测】\\n\\n'\n  \n  if (schemes.value.length > 0) {\n    schemes.value.forEach((scheme, index) => {\n      content += `${index + 1}. [${scheme.id}]\\n`\n      \n      // 获取方案显示数据\n      const schemeDetails = getSchemeDisplayData(scheme)\n      schemeDetails.forEach(detail => {\n        content += `   ${detail}\\n`\n      })\n      content += '\\n'\n    })\n  }\n  \n  // 使用获取到的期号，即使是0也使用\n  const validIssueNumber = issueNumber.value || '0'\n  content += `期号: 第${validIssueNumber}期\\n`\n  content += `发布时间: ${new Date().toLocaleString()}`\n  \n  return content\n}\n\n// 处理发布\nconst handlePublish = async () => {\n  if (!canPublish.value) {\n    uni.showToast({\n      title: '请完善方案和图片',\n      icon: 'none'\n    })\n    return\n  }\n\n  if (!uploadedImageUrls.value || uploadedImageUrls.value.length === 0) {\n    uni.showToast({\n      title: '请等待图片上传完成',\n      icon: 'none'\n    })\n    return\n  }\n\n  try {\n    uni.showLoading({\n      title: '发布中...'\n    })\n\n    // 获取当前登录用户的头像URL\n    let currentUserAvatar = ''\n    const loginData = uni.getStorageSync('loginData') || {}\n    if (loginData.himg) {\n      currentUserAvatar = loginData.himg\n    }\n\n    // 准备发帖数据\n    const postData = {\n      tname: lotteryType.value ? `${lotteryType.value.name}-规律预测` : '规律预测', // 彩票名称 - 添加\"规律预测\"标识\n      issueno: parseInt(issueNumber.value) || 0, // 期号转换为数字\n      content: generatePostContent(), // 发帖内容\n      account: getAccount() || '', // 账号\n      pimg: uploadedImageUrls.value.join(','), // 多张图片URL用逗号分隔\n      flag: false // 需要审核\n    }\n\n    // 检查必要参数\n    if (!postData.account) {\n      uni.showToast({\n        title: '账号信息缺失，请重新登录',\n        icon: 'none'\n      })\n      return\n    }\n\n    if (postData.issueno === null || postData.issueno === undefined || postData.issueno === '') {\n      uni.showToast({\n        title: '期号信息缺失',\n        icon: 'none'\n      })\n      return\n    }\n\n    if (!postData.content) {\n      uni.showToast({\n        title: '发帖内容为空',\n        icon: 'none'\n      })\n      return\n    }\n\n    if (!postData.pimg || postData.pimg.trim() === '') {\n      uni.showToast({\n        title: '请至少上传一张图片',\n        icon: 'none'\n      })\n      return\n    }\n\n    const response = await apiPost(postData)\n\n    uni.hideLoading()\n\n    if (response.code === 200) {\n      // 发帖成功后，保存当前用户的头像信息到本地存储\n      try {\n        const userAvatars = uni.getStorageSync('userAvatars') || {}\n        userAvatars[getAccount()] = currentUserAvatar\n        uni.setStorageSync('userAvatars', userAvatars)\n      } catch (error) {\n        // 静默处理错误\n      }\n\n      uni.showToast({\n        title: '规律帖已提交审核',\n        icon: 'success'\n      })\n\n      // 清除本地存储的方案数据和图片URL\n      uni.removeStorageSync('predict_schemes_data')\n      selectedImages.value = []\n      uploadedImageUrls.value = []\n\n      // 延迟返回规律预测页面\n      setTimeout(() => {\n        uni.navigateBack()\n      }, 1500)\n    } else {\n      uni.showToast({\n        title: response.msg || '发布失败',\n        icon: 'none'\n      })\n    }\n\n  } catch (error) {\n    uni.hideLoading()\n    uni.showToast({\n      title: '发布失败，请重试',\n      icon: 'none'\n    })\n  }\n}\n\n\n\n</script>\n\n<style scoped>\n.pattern-predict-container {\n  min-height: 100vh;\n  background-color: #f5f5f5;\n}\n\n.nav-bar {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 20rpx 30rpx;\n  background-color: #fff;\n  border-bottom: 1rpx solid #eee;\n}\n\n.nav-left {\n  width: 60rpx;\n  height: 60rpx;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.nav-title {\n  font-size: 36rpx;\n  font-weight: bold;\n  color: #333;\n}\n\n.nav-right {\n  width: 60rpx;\n}\n\n.main-content {\n  padding: 30rpx;\n}\n\n.scheme-section {\n  margin-bottom: 40rpx;\n}\n\n.section-title {\n  font-size: 32rpx;\n  font-weight: bold;\n  color: #333;\n  margin-bottom: 20rpx;\n}\n\n.scheme-input {\n  background-color: #fff;\n  border-radius: 16rpx;\n  padding: 30rpx;\n  border: 2rpx solid #eee;\n}\n\n.issue-info {\n  margin-bottom: 20rpx;\n}\n\n.issue-number {\n  font-size: 28rpx;\n  color: #333;\n  font-weight: bold;\n}\n\n.scheme-placeholder {\n  padding: 20rpx 0;\n}\n\n.placeholder-text {\n  font-size: 28rpx;\n  color: #999;\n}\n\n.scheme-display {\n  padding: 20rpx 0;\n}\n\n.scheme-content {\n  background-color: #f8f8f8;\n  padding: 30rpx;\n  border-radius: 15rpx;\n  margin-top: 20rpx;\n}\n\n.scheme-item {\n  margin-bottom: 15rpx;\n}\n\n.scheme-name {\n  font-size: 28rpx;\n  color: #ff4757;\n  font-weight: bold;\n  display: block;\n  margin-bottom: 10rpx;\n}\n\n.scheme-details {\n  display: flex;\n  flex-direction: column;\n  gap: 8rpx;\n}\n\n.scheme-detail {\n  font-size: 26rpx;\n  color: #333;\n  line-height: 1.5;\n}\n\n.image-section {\n  margin-bottom: 40rpx;\n}\n\n.image-upload-container {\n  background-color: #fff;\n  border-radius: 16rpx;\n  padding: 30rpx;\n  border: 2rpx solid #eee;\n}\n\n.selected-images {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 20rpx;\n  margin-bottom: 20rpx;\n}\n\n.image-item {\n  position: relative;\n  width: 200rpx;\n  height: 200rpx;\n}\n\n.uploaded-image {\n  width: 100%;\n  height: 100%;\n  border-radius: 12rpx;\n}\n\n.image-delete {\n  position: absolute;\n  top: -10rpx;\n  right: -10rpx;\n  width: 40rpx;\n  height: 40rpx;\n  background-color: #ff4757;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.add-image-btn {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  width: 200rpx;\n  height: 200rpx;\n  border: 2rpx dashed #ccc;\n  border-radius: 12rpx;\n  background-color: #f8f8f8;\n}\n\n.add-text {\n  font-size: 24rpx;\n  color: #999;\n  margin-top: 10rpx;\n}\n\n.count-text {\n  font-size: 20rpx;\n  color: #ccc;\n  margin-top: 5rpx;\n}\n\n.disclaimer {\n  margin-bottom: 40rpx;\n}\n\n.disclaimer-text {\n  font-size: 24rpx;\n  color: #ff4757;\n  line-height: 1.5;\n}\n\n.bottom-buttons {\n  margin-top: 40rpx;\n  display: flex;\n  gap: 20rpx;\n}\n\n.modify-btn,\n.publish-btn {\n  flex: 1;\n  height: 88rpx;\n  border: none;\n  border-radius: 44rpx;\n  font-size: 32rpx;\n  font-weight: bold;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.modify-btn {\n  background-color: #f0f0f0;\n  color: #666;\n}\n\n.publish-btn {\n  background-color: #ff4757;\n  color: #fff;\n}\n\n.publish-btn.disabled {\n  background-color: #ccc;\n  color: #999;\n}\n</style>\n","import MiniProgramPage from 'C:/Users/Administrator/Desktop/my-painting-rules-project/pages/pattern-predict/pattern-predict.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","computed","onMounted","onShow","getCOSSecretKey","uni","apiGetIssueNo","getAccount","apiPost"],"mappings":"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"}