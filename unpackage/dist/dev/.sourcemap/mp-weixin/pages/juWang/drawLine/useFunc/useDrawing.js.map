{"version":3,"file":"useDrawing.js","sources":["App.vue","main.js","pages/juWang/drawLine/useFunc/useDrawing.js"],"sourcesContent":["<script>\r\n\texport default {\r\n\t\tonLaunch: function() {\r\n\t\t\tconsole.log('App Launch')\r\n\t\t},\r\n\t\tonShow: function() {\r\n\t\t\tconsole.log('App Show')\r\n\t\t},\r\n\t\tonHide: function() {\r\n\t\t\tconsole.log('App Hide')\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t/*每个页面公共css */\r\n</style>\r\n","import App from './App'\r\nimport vuex from 'vuex'\r\n\r\nconst platform = uni.getSystemInfoSync().platform;\r\n\r\nconst isH5 = platform === 'web'|| platform === 'windows'||platform === 'mac';//判断是否是h5环境中\r\nconst isApp = platform === 'android' || platform === 'ios';//判断小程序是否是安卓或者苹果环境中\r\nconsole.log(vuex)\r\n\r\n\r\n\r\n\r\n//如果是vue3环境下（文件从这里进去的）\r\n// #ifdef VUE3\r\nimport * as Pinia from 'pinia';\r\n// import '@dcloudio/uni-icons/css/uni-icons.css';\r\nimport { createSSRApp } from 'vue'\r\nexport function createApp() {\r\n  const app = createSSRApp(App)\r\n  app.use(Pinia.createPinia())\r\n  return {\r\n    app,\r\n\tPinia\r\n  }\r\n}\r\n// #endif\r\n\r\nexport { isH5, isApp };//导出判断h5或者app","import {\r\n\tisApp,\r\n\tisH5\r\n} from '../../../../main';\r\nimport {\r\n\tref,\r\n\tnextTick\r\n} from 'vue';\r\n\r\n//查看平台（环境）\r\nconsole.log(isApp, isH5, uni.getSystemInfoSync().platform)\r\n\r\n\r\nexport default function useDrawing(numberGroups, highlighted, numberRefs, showNumberSelectorCallback, isH5,\r\n\tdrawCanvasRef, tempCanvasRef) {\r\n\r\n\t//初始化H5状态决定下面的if判断进步进入\r\n\t// isH5 = platform === 'web'|| platform === 'windows'||platform === 'mac';//判断是否是h5环境中\r\n\t// const isApp = platform === 'android' || platform === 'ios';//判断小程序是否是安卓或者苹果环境中\r\n\r\n\t// 模式状态管理\r\n\tconst currentMode = ref('freeDraw'); // straightLine,freeDraw, rectangle, circle, smart, text, eraser\r\n\tconst isDrawing = ref(false);\r\n\tconst isErasing = ref(false);\r\n\t// 控制Canvas的事件穿透\r\n\tconst canvasPointerEvents = ref('auto');\r\n\r\n\t// 固定样式设置\r\n\tconst strokeColor = ref('#3B82F6');\r\n\tconst lineWidth = ref(3);\r\n\r\n\t// Canvas相关\r\n\tconst canvasCtx = ref(null);\r\n\tconst tempCanvasCtx = ref(null);\r\n\tconst canvasSize = ref({\r\n\t\tw: 0,\r\n\t\th: 0\r\n\t});\r\n\tconst dpr = ref(1);\r\n\r\n\t// 绘制状态\r\n\tconst currentShape = ref({\r\n\t\tstart: {\r\n\t\t\tx: 0,\r\n\t\t\ty: 0\r\n\t\t},\r\n\t\tend: {\r\n\t\t\tx: 0,\r\n\t\t\ty: 0\r\n\t\t},\r\n\t\tpoints: [] // 用于自由绘制的点数组\r\n\t});\r\n\tconst shapes = ref([]); // 存储所有绘制的图形\r\n\r\n\t// 橡皮擦相关配置\r\n\tconst eraserSize = ref(30);\r\n\r\n\t// 重置当前图形\r\n\tconst resetCurrentShape = () => {\r\n\t\tcurrentShape.value = {\r\n\t\t\tstart: {\r\n\t\t\t\tx: 0,\r\n\t\t\t\ty: 0\r\n\t\t\t},\r\n\t\t\tend: {\r\n\t\t\t\tx: 0,\r\n\t\t\t\ty: 0\r\n\t\t\t},\r\n\t\t\tpoints: []\r\n\t\t};\r\n\t};\r\n\r\n\t// 检查点是否在不可绘制区域（前两列）\r\n\tconst isPointInNonDrawableArea = (point) => {\r\n\t\tconst canvasDomRect = canvasCtx.value?.canvas.getBoundingClientRect();\r\n\t\tif (!canvasDomRect) return false;\r\n\r\n\t\t// 获取表格元素\r\n\t\tconst table = document.querySelector('.numbers-table');\r\n\t\tif (!table) return false;\r\n\r\n\t\t// 获取表格第一列的DOM元素\r\n\t\tconst firstColCells = table.querySelectorAll('.col-1');\r\n\r\n\t\tif (!firstColCells.length) return false;\r\n\r\n\t\t// 获取第一列的宽度作为不可绘制区域的边界\r\n\t\tconst firstColWidth = firstColCells[0].getBoundingClientRect().width;\r\n\t\tconst totalNonDrawableWidth = firstColWidth;\r\n\r\n\t\t// 计算点在表格中的相对X坐标\r\n\t\tconst tableRect = table.getBoundingClientRect();\r\n\t\tconst pointXInTable = point.x + canvasDomRect.left - tableRect.left;\r\n\r\n\t\t// 如果点在前两列范围内，返回true\r\n\t\treturn pointXInTable <= totalNonDrawableWidth;\r\n\t};\r\n\r\n\t// 检查点是否在数字元素上（仅第3-7列）\r\n\tconst checkPointOnNumber = (point) => {\r\n\t\t// 首先检查是否在前两列的不可绘制区域\r\n\t\tif (isPointInNonDrawableArea(point)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tif (!numberRefs.value || numberRefs.value.length === 0) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tfor (let i = 0; i < numberRefs.value.length; i++) {\r\n\t\t\tlet el = numberRefs.value[i];\r\n\r\n\t\t\tif (el && el.$el) {\r\n\t\t\t\tel = el.$el;\r\n\t\t\t}\r\n\r\n\t\t\tif (!el || !(el instanceof HTMLElement) || !el.getBoundingClientRect) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\ttry {\r\n\t\t\t\tconst rect = el.getBoundingClientRect();\r\n\t\t\t\tconst canvasRect = canvasCtx.value?.canvas.getBoundingClientRect();\r\n\r\n\t\t\t\tif (!canvasRect) continue;\r\n\r\n\t\t\t\tconst adjustedX = point.x + canvasRect.left;\r\n\t\t\t\tconst adjustedY = point.y + canvasRect.top;\r\n\r\n\t\t\t\tif (adjustedX >= rect.left && adjustedX <= rect.right &&\r\n\t\t\t\t\tadjustedY >= rect.top && adjustedY <= rect.bottom) {\r\n\t\t\t\t\t// 获取该数字所在的组索引和数字索引\r\n\t\t\t\t\tconst groupIndex = parseInt(el.dataset.groupIndex);\r\n\t\t\t\t\tconst numIndex = parseInt(el.dataset.numIndex);\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tgroupIndex,\r\n\t\t\t\t\t\tnumIndex\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.error('检查点在数字上时出错:', error);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t};\r\n\r\n\t/**\r\n\t * 清除临时画布\r\n\t */\r\n\tconst clearTempCanvas = () => {\r\n\t\tif (tempCanvasCtx.value) {\r\n\t\t\ttempCanvasCtx.value.clearRect(0, 0, canvasSize.value.w, canvasSize.value.h);\r\n\t\t}\r\n\t};\r\n\r\n\t/**\r\n\t * 绘制直线\r\n\t */\r\n\tconst drawStraightLine = (start, end, color, width, context = canvasCtx.value) => {\r\n\t\tif (!context) return;\r\n\t\t// 检查起点或终点是否在前两列，若是则不绘制\r\n\t\tif (isPointInNonDrawableArea(start) || isPointInNonDrawableArea(end)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tcontext.beginPath();\r\n\t\tcontext.moveTo(start.x, start.y);\r\n\t\tcontext.lineTo(end.x, end.y);\r\n\t\tcontext.strokeStyle = color;\r\n\t\tcontext.lineWidth = width;\r\n\t\tcontext.lineCap = 'round';\r\n\t\tcontext.lineJoin = 'round';\r\n\t\tcontext.stroke();\r\n\t};\r\n\r\n\t/**\r\n\t * 绘制自由线条\r\n\t */\r\n\tconst drawFreeLine = (points, color, width, context = canvasCtx.value) => {\r\n\t\tif (!context || points.length < 2) return; // 如果上下文不存在或点数少于2（无法形成一条线），则直接返回\r\n\r\n\t\t// 过滤掉前两列区域的点\r\n\t\tconst filteredPoints = points.filter(point => !isPointInNonDrawableArea(point));\r\n\r\n\t\tif (filteredPoints.length < 2) return; // 如果过滤后的点数少于2，则返回（无法绘制）\r\n\r\n\t\tcontext.beginPath();\r\n\t\tcontext.moveTo(filteredPoints[0].x, filteredPoints[0].y);\r\n\r\n\t\tfor (let i = 1; i < filteredPoints.length; i++) {\r\n\t\t\tcontext.lineTo(filteredPoints[i].x, filteredPoints[i].y);\r\n\t\t}\r\n\r\n\t\tcontext.strokeStyle = color;\r\n\t\tcontext.lineWidth = width;\r\n\t\tcontext.lineCap = 'round';\r\n\t\tcontext.lineJoin = 'round';\r\n\t\tcontext.stroke();\r\n\t};\r\n\r\n\t/**\r\n\t * 绘制矩形\r\n\t */\r\n\tconst drawRectangle = (start, end, color, width, context = canvasCtx.value) => {\r\n\t\t\r\n\t\tif (!context) return;\r\n\r\n\t\t// 检查起点或终点是否在前两列，若是则不绘制\r\n\t\tif (isPointInNonDrawableArea(start) || isPointInNonDrawableArea(end)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst x = Math.min(start.x, end.x);\r\n\t\tconst y = Math.min(start.y, end.y);\r\n\t\tconst widthRect = Math.abs(end.x - start.x);\r\n\t\tconst heightRect = Math.abs(end.y - start.y);\r\n\r\n\t\tcontext.strokeStyle = color;\r\n\t\tcontext.lineWidth = 6;\r\n\t\tcontext.strokeRect(x, y, widthRect, heightRect);\r\n\t\t\r\n\t};\r\n\r\n\t// 绘制椭圆路径（兼容方案）\r\n\tconst drawEllipsePath = (ctx, cx, cy, rx, ry) => {\r\n\t\t// 使用贝塞尔曲线模拟椭圆\r\n\t\tconst kappa = 0.5522848;\r\n\t\tconst ox = rx * kappa; // 水平控制点偏移\r\n\t\tconst oy = ry * kappa; // 垂直控制点偏移\r\n\r\n\t\tctx.beginPath();\r\n\t\t// 从右中开始\r\n\t\tctx.moveTo(cx + rx, cy);\r\n\t\t// 右上弧线\r\n\t\tctx.bezierCurveTo(cx + rx, cy - oy, cx + ox, cy - ry, cx, cy - ry);\r\n\t\t// 左上弧线\r\n\t\tctx.bezierCurveTo(cx - ox, cy - ry, cx - rx, cy - oy, cx - rx, cy);\r\n\t\t// 左下弧线\r\n\t\tctx.bezierCurveTo(cx - rx, cy + oy, cx - ox, cy + ry, cx, cy + ry);\r\n\t\t// 右下弧线\r\n\t\tctx.bezierCurveTo(cx + ox, cy + ry, cx + rx, cy + oy, cx + rx, cy);\r\n\t\tctx.closePath();\r\n\t};\r\n\r\n\t/**\r\n\t * 绘制圆形\r\n\t */\r\n\tconst drawCircle = (start, end, color, width, context = canvasCtx.value) => {\r\n\t\tif (!context) return;\r\n\r\n\t\t// 检查起点或终点是否在前两列，若是则不绘制\r\n\t\tif (isPointInNonDrawableArea(start) || isPointInNonDrawableArea(end)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst xRadius = Math.abs(end.x - start.x) / 2;\r\n\t\tconst yRadius = Math.abs(end.y - start.y) / 2;\r\n\t\tconst centerX = start.x + (end.x - start.x) / 2;\r\n\t\tconst centerY = start.y + (end.y - start.y) / 2;\r\n\r\n\t\t// 绘制当前椭圆（使用兼容方法）\r\n\t\tdrawEllipsePath(context, centerX, centerY, xRadius, yRadius);\r\n\r\n\t\tcontext.strokeStyle = color;\r\n\t\tcontext.lineWidth = width;\r\n\t\tcontext.stroke();\r\n\t};\r\n\t/**\r\n\t * 绘制智能曲线，包括当前线条、上两格线条和上四格线条\r\n\t */\r\n\tconst drawSmartCurve = (start, end, color2, width, context = canvasCtx.value, point) => {\r\n\t\tlet color = \"#1a1ad9\"\r\n\t\tif (!context) return;\r\n\t\t// 检查起点或终点是否在前两列，若是则不绘制\r\n\t\tif (isPointInNonDrawableArea(start) || isPointInNonDrawableArea(end)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// 检查起点是否在数字上，并添加高亮\r\n\t\tconst startNum = checkPointOnNumber(start);\r\n\t\tif (startNum) {\r\n\t\t\tconst exists = highlighted.value.some(\r\n\t\t\t\titem => item.groupIndex === startNum.groupIndex &&\r\n\t\t\t\titem.numIndex === startNum.numIndex\r\n\t\t\t);\r\n\t\t\tif (!exists) {\r\n\t\t\t\thighlighted.value.push({\r\n\t\t\t\t\tgroupIndex: startNum.groupIndex,\r\n\t\t\t\t\tnumIndex: startNum.numIndex,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// 计算控制点（让曲线弧度朝下）\r\n\t\tconst controlX = start.x;\r\n\r\n\t\tconst controlY = start.y;\r\n\t\t// 计算行高（用于线条位置计算）\r\n\t\tconst rowHeight = canvasSize.value.h / numberGroups.value;\r\n\t\t// 绘制当前线条\r\n\t\tcontext.beginPath();\r\n\r\n\r\n\t\tcontext.moveTo(start.x, start.y);\r\n\t\tcontext.quadraticCurveTo(controlX, controlY, end.x, end.y);\r\n\t\tcontext.strokeStyle = color;\r\n\t\tcontext.lineWidth = width;\r\n\t\tcontext.lineCap = 'round';\r\n\t\tcontext.stroke();\r\n\t\t// console.log(2);\r\n\r\n\t\t// 绘制当前点指示\r\n\t\tcontext.fillStyle = color;\r\n\t\tcontext.beginPath();\r\n\t\tcontext.arc(start.x, start.y, 5, 0, Math.PI * 2);\r\n\t\tcontext.arc(end.x, end.y, 5, 0, Math.PI * 2);\r\n\t\tcontext.fill();\r\n\r\n\t\t// 上两格线条\r\n\t\t// const twoUpStart = {\r\n\t\t// \tx: start.x,\r\n\t\t// \ty: start.y - rowHeight * 3\r\n\t\t// };\r\n\t\t// const twoUpEnd = {\r\n\t\t// \tx: end.x,\r\n\t\t// \ty: end.y - rowHeight * 3\r\n\t\t// };\r\n\t\t// const twoUpControlY = controlY - rowHeight * 3;\r\n\r\n\t\t// context.beginPath();\r\n\t\t// context.moveTo(twoUpStart.x, twoUpStart.y);\r\n\t\t// context.quadraticCurveTo(controlX, twoUpControlY, twoUpEnd.x, twoUpEnd.y);\r\n\t\t// context.strokeStyle = `${color}`; // 透明度80%\r\n\t\t// context.lineWidth = width;\r\n\t\t// context.lineCap = 'round';\r\n\t\t// context.stroke();\r\n\r\n\t\t// // 上两格点指示\r\n\t\t// context.fillStyle = `${color}`;\r\n\t\t// context.beginPath();\r\n\t\t// context.arc(twoUpStart.x, twoUpStart.y, 4, 0, Math.PI * 2);\r\n\t\t// context.arc(twoUpEnd.x, twoUpEnd.y, 4, 0, Math.PI * 2);\r\n\t\t// context.fill();\r\n\r\n\t\t// 上四格线条\r\n\t\t// const fourUpStart = {\r\n\t\t// \tx: start.x,\r\n\t\t// \ty: start.y - rowHeight * 6\r\n\t\t// };\r\n\t\t// const fourUpEnd = {\r\n\t\t// \tx: end.x,\r\n\t\t// \ty: end.y - rowHeight * 6\r\n\t\t// };\r\n\t\t// const fourUpControlY = controlY - rowHeight * 6;\r\n\r\n\t\t// context.beginPath();\r\n\t\t// context.moveTo(fourUpStart.x, fourUpStart.y);\r\n\t\t// context.quadraticCurveTo(controlX, fourUpControlY, fourUpEnd.x, fourUpEnd.y);\r\n\t\t// context.strokeStyle = `${color}`; // 透明度50%\r\n\t\t// context.lineWidth = width;\r\n\t\t// context.lineCap = 'round';\r\n\t\t// context.stroke();\r\n\r\n\t\t// 上四格点指示\r\n\t\t// context.fillStyle = `${color}50`;\r\n\t\t// context.beginPath();\r\n\t\t// context.arc(fourUpStart.x, fourUpStart.y, 4, 0, Math.PI * 2);\r\n\t\t// context.arc(fourUpEnd.x, fourUpEnd.y, 4, 0, Math.PI * 2);\r\n\t\t// context.fill();\r\n\t};\r\n\r\n\t/**\r\n\t * 计算点到直线的距离\r\n\t */\r\n\tconst pointLineDistance = (point, start, end) => {\r\n\t\tconst A = point.x - start.x;\r\n\t\tconst B = point.y - start.y;\r\n\t\tconst C = end.x - start.x;\r\n\t\tconst D = end.y - start.y;\r\n\r\n\t\tconst dot = A * C + B * D;\r\n\t\tconst lenSq = C * C + D * D;\r\n\t\tlet param = -1;\r\n\r\n\t\tif (lenSq !== 0) param = dot / lenSq;\r\n\r\n\t\tlet xx, yy;\r\n\r\n\t\tif (param < 0) {\r\n\t\t\txx = start.x;\r\n\t\t\tyy = start.y;\r\n\t\t} else if (param > 1) {\r\n\t\t\txx = end.x;\r\n\t\t\tyy = end.y;\r\n\t\t} else {\r\n\t\t\txx = start.x + param * C;\r\n\t\t\tyy = start.y + param * D;\r\n\t\t}\r\n\r\n\t\treturn Math.hypot(point.x - xx, point.y - yy);\r\n\t};\r\n\r\n\t/**\r\n\t * 检查点是否靠近形状\r\n\t */\r\n\tconst isPointNearShape = (point, shape) => {\r\n\t\t// 如果点在前两列区域，不执行擦除\r\n\t\tif (isPointInNonDrawableArea(point)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (shape.type === 'freeDraw') {\r\n\t\t\t// 检查是否靠近自由线条的任何线段\r\n\t\t\tfor (let i = 0; i < shape.points.length - 1; i++) {\r\n\t\t\t\tif (pointLineDistance(point, shape.points[i], shape.points[i + 1]) < eraserSize.value / 2) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t} else if (shape.type === 'rectangle' || shape.type === 'straightLine') {\r\n\t\t\t// 简化检查：检查是否在矩形周围区域\r\n\t\t\tconst x = Math.min(shape.start.x, shape.end.x);\r\n\t\t\tconst y = Math.min(shape.start.y, shape.end.y);\r\n\t\t\tconst width = Math.abs(shape.end.x - shape.start.x);\r\n\t\t\tconst height = Math.abs(shape.end.y - shape.start.y);\r\n\r\n\t\t\treturn point.x >= x - eraserSize.value / 2 &&\r\n\t\t\t\tpoint.x <= x + width + eraserSize.value / 2 &&\r\n\t\t\t\tpoint.y >= y - eraserSize.value / 2 &&\r\n\t\t\t\tpoint.y <= y + height + eraserSize.value / 2;\r\n\t\t} else if (shape.type === 'circle') {\r\n\t\t\t// 检查是否靠近圆形\r\n\t\t\tconst radius = Math.sqrt(\r\n\t\t\t\tMath.pow(shape.end.x - shape.start.x, 2) +\r\n\t\t\t\tMath.pow(shape.end.y - shape.start.y, 2)\r\n\t\t\t);\r\n\t\t\tconst distanceFromCenter = Math.hypot(point.x - shape.start.x, point.y - shape.start.y);\r\n\r\n\t\t\t// 检查是否在圆内或靠近圆周\r\n\t\t\treturn Math.abs(distanceFromCenter - radius) < eraserSize.value / 2 ||\r\n\t\t\t\tdistanceFromCenter < eraserSize.value / 2;\r\n\t\t} else if (shape.type === 'smart') {\r\n\t\t\t// 检查是否靠近智能曲线\r\n\t\t\tconst controlX = (shape.start.x + shape.end.x) / 2;\r\n\t\t\tconst controlY = (shape.start.y + shape.end.y) / 2 + Math.abs(shape.start.x - shape.end.x) / 3;\r\n\r\n\t\t\t// 简化检查：检查与起点、终点和控制点的距离\r\n\t\t\tconst distToStart = Math.hypot(point.x - shape.start.x, point.y - shape.start.y);\r\n\t\t\tconst distToEnd = Math.hypot(point.x - shape.end.x, point.y - shape.end.y);\r\n\t\t\tconst distToControl = Math.hypot(point.x - controlX, point.y - controlY);\r\n\r\n\t\t\treturn Math.min(distToStart, distToEnd, distToControl) < eraserSize.value / 1.5;\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t};\r\n\r\n\t/**\r\n\t * 检查点是否在文字标签上\r\n\t */\r\n\tconst checkPointOnTextLabel = (point) => {\r\n\t\t// 如果点在前两列区域，不执行操作\r\n\t\tif (isPointInNonDrawableArea(point)) {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\r\n\t\t// 这个函数需要访问textLabels，我们从主组件传入或通过其他方式获取\r\n\t\t// 这里假设在主组件中会处理文字标签的擦除\r\n\t\treturn -1;\r\n\t};\r\n\r\n\t/**\r\n\t * 执行擦除操作\r\n\t */\r\n\tconst performErase = (point) => {\r\n\t\t// 如果点在前两列区域，不执行擦除\r\n\t\tif (isPointInNonDrawableArea(point)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// 1. 检查是否擦到数字高亮\r\n\t\tconst numberPos = checkPointOnNumber(point);\r\n\t\tif (numberPos) {\r\n\t\t\tconst {\r\n\t\t\t\tgroupIndex,\r\n\t\t\t\tnumIndex\r\n\t\t\t} = numberPos;\r\n\t\t\tconst idx = highlighted.value.findIndex(item =>\r\n\t\t\t\titem.groupIndex === groupIndex && item.numIndex === numIndex\r\n\t\t\t);\r\n\t\t\tif (idx > -1) {\r\n\t\t\t\thighlighted.value.splice(idx, 1);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// 2. 检查是否擦到形状（从后往前检查）\r\n\t\tfor (let i = shapes.value.length - 1; i >= 0; i--) {\r\n\t\t\tif (isPointNearShape(point, shapes.value[i])) {\r\n\t\t\t\tshapes.value.splice(i, 1);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t/**\r\n\t * 获取相对Canvas的坐标\r\n\t */\r\n\tconst getRelativeCoordinates = (e) => {\r\n\t\tconst canvas = canvasCtx.value?.canvas;\r\n\t\tif (!canvas) return {\r\n\t\t\tx: 0,\r\n\t\t\ty: 0\r\n\t\t};\r\n\r\n\t\tconst canvasDomRect = canvas.getBoundingClientRect();\r\n\t\tif (!canvasDomRect) return {\r\n\t\t\tx: 0,\r\n\t\t\ty: 0\r\n\t\t};\r\n\r\n\t\tlet clientX, clientY;\r\n\r\n\t\t// 处理不同环境下的坐标获取\r\n\t\tif (e.touches && e.touches.length > 0) {\r\n\t\t\t// 移动端触摸事件\r\n\t\t\tclientX = e.touches[0].clientX;\r\n\t\t\tclientY = e.touches[0].clientY;\r\n\t\t} else if (e.clientX !== undefined) {\r\n\t\t\t// PC端鼠标事件\r\n\t\t\tclientX = e.clientX;\r\n\t\t\tconsole.log(clientX)\r\n\t\t\tclientY = e.clientY;\r\n\t\t} else {\r\n\t\t\t// 其他情况\r\n\t\t\treturn {\r\n\t\t\t\tx: 0,\r\n\t\t\t\ty: 0\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tx: clientX - canvasDomRect.left,\r\n\t\t\ty: clientY - canvasDomRect.top\r\n\t\t};\r\n\t};\r\n\r\n\t/**\r\n\t * 开始画布操作\r\n\t */\r\n\tconst onCanvasStart = (e) => {\r\n\t\tconsole.log('Canvas 开始操作');\r\n\t\tconst coords = getRelativeCoordinates(e);\r\n\r\n\t\t// 如果点在前两列区域，不执行任何绘制操作并允许事件穿透\r\n\t\tif (isPointInNonDrawableArea(coords)) {\r\n\t\t\te.stopPropagation();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// 点击Canvas时禁用事件穿透\r\n\t\tcanvasPointerEvents.value = 'none';\r\n\r\n\t\t// 使用定时器将时间穿透恢复\r\n\t\tlet timerId = null;\r\n\t\tif (timerId) {\r\n\t\t\tclearTimeout(timerId);\r\n\t\t\ttimerId = null;\r\n\t\t}\r\n\t\ttimerId = setTimeout(() => {\r\n\t\t\tcanvasPointerEvents.value = 'auto';\r\n\t\t\ttimerId = null;\r\n\t\t}, 300);\r\n\r\n\r\n\r\n\t\tif (currentMode.value === 'eraser') {\r\n\t\t\t// 橡皮擦模式\r\n\t\t\tisErasing.value = true;\r\n\t\t\tperformErase(coords);\r\n\t\t\tredraw(false);\r\n\t\t} else if (['straightLine', 'freeDraw', 'rectangle', 'circle', 'smart'].includes(currentMode.value)) {\r\n\t\t\t// 绘图模式\r\n\t\t\tisDrawing.value = true;\r\n\t\t\tcurrentShape.value.start = {\r\n\t\t\t\t...coords\r\n\t\t\t};\r\n\t\t\tcurrentShape.value.end = {\r\n\t\t\t\t...coords\r\n\t\t\t};\r\n\r\n\t\t\t// 自由绘制模式下记录第一个点\r\n\t\t\tif (currentMode.value === 'freeDraw') {\r\n\t\t\t\tcurrentShape.value.points = [coords];\r\n\t\t\t\t//测试代码\r\n\t\t\t\tconsole.log(currentShape.value.points)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t};\r\n\r\n\r\n\r\n\r\n\tlet animationFrameId = null;\r\n\t/**\r\n\t * 画布移动操作\r\n\t */\r\n\tconst onCanvasMove = (e) => {\r\n\t\t// if (!canvasCtx.value || (!isDrawing.value && !isErasing.value)) {\r\n\t\t// \tconsole.log('Canvas 上下文未初始化或未处于绘制状态',canvasCtx.value);\r\n\t\t// \treturn;\r\n\t\t// }\r\n\r\n\t\t// 取消之前的动画帧\r\n\t\tif (animationFrameId) {\r\n\t\t\tcancelAnimationFrame(animationFrameId);\r\n\t\t}\r\n\t\tanimationFrameId = requestAnimationFrame(() => {\r\n\t\t\t// 获取坐标\r\n\t\t\tconst coords = getRelativeCoordinates(e);\r\n\r\n\t\t\t// ...其他逻辑\r\n\r\n\t\t\tif (isDrawing.value) {\r\n\t\t\t\t// 更新当前点\r\n\t\t\t\tcurrentShape.value.end = {\r\n\t\t\t\t\t...coords\r\n\t\t\t\t};\r\n\r\n\t\t\t\t// 自由绘制模式下记录所有点\r\n\t\t\t\tif (currentMode.value === 'freeDraw') {\r\n\t\t\t\t\tcurrentShape.value.points.push(coords);\r\n\t\t\t\t}\r\n\t\t\t\t// 绘制临时预览\r\n\t\t\t\tdrawTemporaryShape(true);\r\n\t\t\t}\r\n\r\n\t\t\tanimationFrameId = null;\r\n\t\t});\r\n\r\n\r\n\r\n\t\tconst coords = getRelativeCoordinates(e);\r\n\r\n\t\t// 如果点在前两列区域，不执行任何操作\r\n\t\tif (isPointInNonDrawableArea(coords)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\te.preventDefault();\r\n\r\n\t\tif (currentMode.value === 'eraser' && isErasing.value) {\r\n\t\t\t// 橡皮擦移动擦除\r\n\t\t\tperformErase(coords);\r\n\t\t\tredraw(false);\r\n\t\t} else if (isDrawing.value) {\r\n\t\t\t// 更新当前点\r\n\t\t\tcurrentShape.value.end = {\r\n\t\t\t\t...coords\r\n\t\t\t};\r\n\r\n\t\t\t// 自由绘制模式下记录所有点\r\n\t\t\tif (currentMode.value === 'freeDraw') {\r\n\t\t\t\tcurrentShape.value.points.push(coords);\r\n\t\t\t}\r\n\r\n\t\t\t// 绘制临时预览，鼠标按住移动的时候绘制，根据当前是什么绘制类型，来绘制不同的\r\n\t\t\tdrawTemporaryShape();\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * 绘制临时形状（用于预览）就是画的时候路线会随着鼠标移动即时更新\r\n\t */\r\n\tconst drawTemporaryShape = () => {\r\n\t\tif (!tempCanvasCtx.value) return;\r\n\r\n\t\t// 如果是自由绘制模式且处于绘制中，采用增量绘制\r\n\t\tif (currentMode.value === 'freeDraw' && isDrawing.value && currentShape.value.points.length > 1) {\r\n\t\t\t// 只绘制当前新增的线段\r\n\t\t\tconst points = currentShape.value.points;\r\n\t\t\tconst startPoint = points[points.length - 2];\r\n\t\t\tconst endPoint = points[points.length - 1];\r\n\r\n\r\n\t\t\ttempCanvasCtx.value.beginPath();\r\n\t\t\ttempCanvasCtx.value.moveTo(startPoint.x, startPoint.y);\r\n\t\t\ttempCanvasCtx.value.lineTo(endPoint.x, endPoint.y);\r\n\t\t\ttempCanvasCtx.value.strokeStyle = strokeColor.value;\r\n\t\t\ttempCanvasCtx.value.lineWidth = lineWidth.value;\r\n\t\t\ttempCanvasCtx.value.lineCap = 'round';\r\n\t\t\ttempCanvasCtx.value.stroke();\r\n\t\t} else {\r\n\r\n\r\n\t\t\t// 先把之前画的内容也绘制到临时画布\r\n\t\t\tconsole.log(tempCanvasCtx)\r\n\t\t\tif (tempCanvasCtx.value) {\r\n\t\t\t\ttempCanvasCtx.value.clearRect(0, 0, canvasSize.value.w, canvasSize.value.h);\r\n\t\t\t\t// 把所有已保存的图形绘制到临时画布\r\n\t\t\t\tshapes.value.forEach(shape => {\r\n\t\t\t\t\tswitch (shape.type) {\r\n\t\t\t\t\t\tcase 'straightLine':\r\n\t\t\t\t\t\t\tdrawStraightLine(shape.start, shape.end, shape.color, shape.width, tempCanvasCtx\r\n\t\t\t\t\t\t\t\t.value);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'freeDraw':\r\n\t\t\t\t\t\t\tdrawFreeLine(shape.points, shape.color, shape.width, tempCanvasCtx.value);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'rectangle':\r\n\t\t\t\t\t\t\tdrawRectangle(shape.start, shape.end, shape.color, shape.width, tempCanvasCtx\r\n\t\t\t\t\t\t\t\t.value);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'circle':\r\n\t\t\t\t\t\t\tdrawCircle(shape.start, shape.end, shape.color, shape.width, tempCanvasCtx\r\n\t\t\t\t\t\t\t\t.value);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'smart':\r\n\t\t\t\t\t\t\tif (shape.startNum && shape.endNum) {\r\n\t\t\t\t\t\t\t\tdrawSmartCurve(shape.start, shape.end, shape.color, shape.width,\r\n\t\t\t\t\t\t\t\t\ttempCanvasCtx\r\n\t\t\t\t\t\t\t\t\t.value);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tdrawFreeLine([shape.start, shape.end], shape.color, shape.width,\r\n\t\t\t\t\t\t\t\t\ttempCanvasCtx\r\n\t\t\t\t\t\t\t\t\t.value);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// 再绘制当前预览形状\r\n\t\tif (!tempCanvasCtx.value) return;\r\n\r\n\t\tswitch (currentMode.value) {\r\n\t\t\tcase 'straightLine':\r\n\t\t\t\tdrawStraightLine(currentShape.value.start, currentShape.value.end, strokeColor.value, lineWidth\r\n\t\t\t\t\t.value, tempCanvasCtx.value);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'freeDraw':\r\n\t\t\t\tif (currentShape.value.points.length > 1) {\r\n\t\t\t\t\tdrawFreeLine(currentShape.value.points, strokeColor.value, lineWidth.value, tempCanvasCtx\r\n\t\t\t\t\t\t.value);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'rectangle':\r\n\t\t\t\tdrawRectangle(currentShape.value.start, currentShape.value.end, strokeColor.value, lineWidth.value,\r\n\t\t\t\t\ttempCanvasCtx.value);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'circle':\r\n\t\t\t\tdrawCircle(currentShape.value.start, currentShape.value.end, strokeColor.value, lineWidth.value,\r\n\t\t\t\t\ttempCanvasCtx.value);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'smart':\r\n\t\t\t\tconst startNum = checkPointOnNumber(currentShape.value.start);\r\n\t\t\t\tconst endNum = checkPointOnNumber(currentShape.value.end);\r\n\r\n\t\t\t\tif (startNum && endNum) {\r\n\t\t\t\t\tdrawSmartCurve(currentShape.value.start, currentShape.value.end, '#66dd99', lineWidth.value,\r\n\t\t\t\t\t\ttempCanvasCtx.value);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tdrawFreeLine(\r\n\t\t\t\t\t\t[currentShape.value.start, currentShape.value.end],\r\n\t\t\t\t\t\t'#ff6688',\r\n\t\t\t\t\t\tlineWidth.value,\r\n\t\t\t\t\t\ttempCanvasCtx.value\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t};\r\n\r\n\t/**\r\n\t * 结束画布操作\r\n\t */\r\n\tconst onCanvasEnd = () => {\r\n\t\tconst endPoint = currentShape.value.end;\r\n\t\tconst numberPos = checkPointOnNumber(endPoint);\r\n\t\t//为了解决web端绘制无法及时更新\r\n\t\tif (animationFrameId) {\r\n\t\t\tcancelAnimationFrame(animationFrameId);\r\n\t\t\tanimationFrameId = null;\r\n\t\t}\r\n\r\n\r\n\t\tif (numberPos) {\r\n\t\t\tconst {\r\n\t\t\t\tgroupIndex,\r\n\t\t\t\tnumIndex\r\n\t\t\t} = numberPos;\r\n\t\t\tconsole.log(groupIndex,numIndex)\r\n\t\t\t// 如果是智能模式，并且终点在46-49行，1-4列\r\n\t\t\tif (currentMode.value === 'smart' && groupIndex >= 20 && groupIndex <= 23 && numIndex == 0) {\r\n\t\t\t\tif (showNumberSelectorCallback) {\r\n\t\t\t\t\tshowNumberSelectorCallback(groupIndex, numIndex);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (currentMode.value === 'smart' && groupIndex >= 20 && groupIndex <= 23 && numIndex == 1) {\r\n\t\t\t\tif (showNumberSelectorCallback) {\r\n\t\t\t\t\tshowNumberSelectorCallback(groupIndex, numIndex);\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tif (currentMode.value === 'smart' && groupIndex >= 20 && groupIndex <= 23 && numIndex == 2) {\r\n\t\t\t\tif (showNumberSelectorCallback) {\r\n\t\t\t\t\tshowNumberSelectorCallback(groupIndex, numIndex);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (currentMode.value === 'smart' && groupIndex >= 20 && groupIndex <= 23 && numIndex == 3) {\r\n\t\t\t\tif (showNumberSelectorCallback) {\r\n\t\t\t\t\tshowNumberSelectorCallback(groupIndex, numIndex);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (currentMode.value === 'smart' && groupIndex >= 20 && groupIndex <= 23 && numIndex == 4) {\r\n\t\t\t\tif (showNumberSelectorCallback) {\r\n\t\t\t\t\tshowNumberSelectorCallback(groupIndex, numIndex);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (currentMode.value === 'smart' && groupIndex >= 20 && groupIndex <= 23 && numIndex == 5) {\r\n\t\t\t\tif (showNumberSelectorCallback) {\r\n\t\t\t\t\tshowNumberSelectorCallback(groupIndex, numIndex);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\r\n\r\n\t\tif (currentMode.value === 'eraser') {\r\n\t\t\tisErasing.value = false;\r\n\t\t} else if (isDrawing.value) {\r\n\t\t\t// 检查起点或终点是否在前两列区域\r\n\t\t\tif (isPointInNonDrawableArea(currentShape.value.start) ||\r\n\t\t\t\tisPointInNonDrawableArea(currentShape.value.end)) {\r\n\t\t\t\t// 如果任何一点在前两列，不保存形状\r\n\t\t\t\tisDrawing.value = false;\r\n\t\t\t\tresetCurrentShape();\r\n\t\t\t\tclearTempCanvas();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// 保存绘制的形状\r\n\t\t\tconst shape = {\r\n\t\t\t\ttype: currentMode.value,\r\n\t\t\t\tstart: {\r\n\t\t\t\t\t...currentShape.value.start\r\n\t\t\t\t},\r\n\t\t\t\tend: {\r\n\t\t\t\t\t...currentShape.value.end\r\n\t\t\t\t},\r\n\t\t\t\tpoints: [...currentShape.value.points],\r\n\t\t\t\tcolor: strokeColor.value,\r\n\t\t\t\twidth: lineWidth.value\r\n\t\t\t};\r\n\r\n\t\t\t// 仅保存有意义的形状\r\n\t\t\tif (currentMode.value === 'freeDraw' && shape.points.length > 1) {\r\n\t\t\t\t// 过滤掉前两列区域的点\r\n\t\t\t\tshape.points = shape.points.filter(point => !isPointInNonDrawableArea(point));\r\n\t\t\t\tif (shape.points.length > 1) {\r\n\t\t\t\t\tshapes.value.push(shape);\r\n\t\t\t\t}\r\n\t\t\t} else if (['rectangle', 'straightLine', 'circle'].includes(currentMode.value)) {\r\n\t\t\t\tconst size = Math.hypot(\r\n\t\t\t\t\tshape.end.x - shape.start.x,\r\n\t\t\t\t\tshape.end.y - shape.start.y\r\n\t\t\t\t);\r\n\t\t\t\tif (size > 5) { // 忽略太小的形状\r\n\t\t\t\t\tshapes.value.push(shape);\r\n\t\t\t\t}\r\n\t\t\t} else if (currentMode.value === 'smart') {\r\n\t\t\t\tconst startNum = checkPointOnNumber(shape.start);\r\n\t\t\t\tconst endNum = checkPointOnNumber(shape.end);\r\n\t\t\t\tconst lineLength = Math.hypot(\r\n\t\t\t\t\tshape.end.x - shape.start.x,\r\n\t\t\t\t\tshape.end.y - shape.start.y\r\n\t\t\t\t);\r\n\r\n\t\t\t\tif (lineLength > 10) {\r\n\t\t\t\t\t// 保存智能模式信息\r\n\t\t\t\t\tshape.startNum = startNum;\r\n\t\t\t\t\tshape.endNum = endNum;\r\n\t\t\t\t\tshapes.value.push(shape);\r\n\r\n\r\n\t\t\t\t\tif (startNum && endNum) {\r\n\t\t\t\t\t\t// 辅助函数：添加高亮（避免重复）\r\n\t\t\t\t\t\tconst addHighlight = (groupIdx, numIdx) => {\r\n\t\t\t\t\t\t\tconst exists = highlighted.value.some(\r\n\t\t\t\t\t\t\t\titem => item.groupIndex === groupIdx && item.numIndex === numIdx\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tif (!exists) {\r\n\t\t\t\t\t\t\t\thighlighted.value.push({\r\n\t\t\t\t\t\t\t\t\tgroupIndex: groupIdx,\r\n\t\t\t\t\t\t\t\t\tnumIndex: numIdx,\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t// 高亮当前格子\r\n\t\t\t\t\t\taddHighlight(startNum.groupIndex, startNum.numIndex);\r\n\t\t\t\t\t\taddHighlight(endNum.groupIndex, endNum.numIndex);\r\n\r\n\r\n\t\t\t\t\t\t// 计算上两格的格子索引并高亮（确保不小于0）\r\n\t\t\t\t\t\t// const twoUpStartGroup = startNum.groupIndex - 3;\r\n\t\t\t\t\t\t// const twoUpEndGroup = endNum.groupIndex - 3;\r\n\t\t\t\t\t\t// if (twoUpStartGroup >= 0) {\r\n\t\t\t\t\t\t// \taddHighlight(twoUpStartGroup, startNum.numIndex);\r\n\t\t\t\t\t\t// }\r\n\t\t\t\t\t\t// if (twoUpEndGroup >= 0) {\r\n\t\t\t\t\t\t// \taddHighlight(twoUpEndGroup, endNum.numIndex);\r\n\t\t\t\t\t\t// }\r\n\r\n\t\t\t\t\t\t// 计算上四格的格子索引并高亮（确保不小于0）\r\n\t\t\t\t\t\t// const fourUpStartGroup = startNum.groupIndex - 6;\r\n\t\t\t\t\t\t// const fourUpEndGroup = endNum.groupIndex - 6;\r\n\t\t\t\t\t\t// if (fourUpStartGroup >= 0) {\r\n\t\t\t\t\t\t// \taddHighlight(fourUpStartGroup, startNum.numIndex);\r\n\t\t\t\t\t\t// }\r\n\t\t\t\t\t\t// if (fourUpEndGroup >= 0) {\r\n\t\t\t\t\t\t// \taddHighlight(fourUpEndGroup, endNum.numIndex);\r\n\t\t\t\t\t\t// }\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tisDrawing.value = false;\r\n\t\t\tresetCurrentShape();\r\n\t\t\tclearTempCanvas();\r\n\t\t\tredraw(false);\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * 重绘所有内容\r\n\t */\r\n\tconst redraw = (includeTemp = false) => {\r\n\t\tif (!canvasCtx.value) return;\r\n\r\n\t\t// 清空画布\r\n\t\tcanvasCtx.value.clearRect(0, 0, canvasSize.value.w, canvasSize.value.h);\r\n\r\n\t\t// 绘制所有保存的形状\r\n\t\tshapes.value.forEach(shape => {\r\n\t\t\tswitch (shape.type) {\r\n\t\t\t\tcase 'straightLine':\r\n\t\t\t\t\tdrawStraightLine(shape.start, shape.end, shape.color, shape.width);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'freeDraw':\r\n\t\t\t\t\tdrawFreeLine(shape.points, shape.color, shape.width);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'rectangle':\r\n\t\t\t\t\tdrawRectangle(shape.start, shape.end, shape.color, shape.width);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'circle':\r\n\t\t\t\t\tdrawCircle(shape.start, shape.end, shape.color, shape.width);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'smart':\r\n\t\t\t\t\tif (shape.startNum && shape.endNum) {\r\n\t\t\t\t\t\tdrawSmartCurve(shape.start, shape.end, shape.color, shape.width);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tdrawFreeLine([shape.start, shape.end], shape.color, shape.width);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// 橡皮擦模式下绘制指示器\r\n\t\tif (currentMode.value === 'eraser' && isErasing.value) {\r\n\t\t\tdrawEraserIndicator();\r\n\t\t}\r\n\t};\r\n\r\n\t/**\r\n\t * 绘制橡皮擦指示\r\n\t */\r\n\tconst drawEraserIndicator = () => {\r\n\t\tif (!canvasCtx.value) return;\r\n\r\n\t\tconst lastPoint = currentShape.value.end;\r\n\t\tcanvasCtx.value.beginPath();\r\n\t\tcanvasCtx.value.arc(lastPoint.x, lastPoint.y, eraserSize.value / 2, 0, Math.PI * 2);\r\n\t\tcanvasCtx.value.strokeStyle = 'rgba(255, 0, 0, 0.5)';\r\n\t\tcanvasCtx.value.lineWidth = 2;\r\n\t\tcanvasCtx.value.stroke();\r\n\t\tcanvasCtx.value.fillStyle = 'rgba(255, 0, 0, 0.1)';\r\n\t\tcanvasCtx.value.fill();\r\n\t};\r\n\r\n\t/**\r\n\t * 安全地移除事件监听器\r\n\t */\r\n\tconst safeRemoveEventListener = (container, event, handler) => {\r\n\t\tif (container && container.removeEventListener) {\r\n\t\t\tcontainer.removeEventListener(event, handler);\r\n\t\t}\r\n\t};\r\n\r\n\t/**\r\n\t * 安全地添加事件监听器\r\n\t */\r\n\tconst safeAddEventListener = (container, event, handler, options) => {\r\n\t\tif (container && container.addEventListener) {\r\n\t\t\tcontainer.addEventListener(event, handler, options);\r\n\r\n\t\t}\r\n\t};\r\n\r\n\t/**\r\n\t * 设置表格滚动监听\r\n\t */\r\n\tconst setupTableScrollListener = () => {\r\n\t\t// 尝试多种可能的滚动容器选择器\r\n\t\tconst possibleContainers = [\r\n\t\t\tdocument.querySelector('.numbers-table-container'), // 表格容器\r\n\t\t\tdocument.querySelector('.container'), // 最外层容器\r\n\t\t\tdocument.querySelector('.numbers-table')?.parentElement, // 表格的直接父元素\r\n\t\t\tdocument.scrollingElement, // 页面滚动容器\r\n\t\t\twindow // 窗口对象\r\n\t\t];\r\n\r\n\t\t// 过滤掉null/undefined的容器\r\n\t\tconst validContainers = possibleContainers.filter(container => container != null);\r\n\r\n\t\t// 为每个有效的容器添加滚动事件监听\r\n\t\tvalidContainers.forEach(container => {\r\n\t\t\t// 先移除可能存在的旧监听，避免重复\r\n\t\t\tsafeRemoveEventListener(container, 'scroll', handleTableScroll);\r\n\t\t\t// 添加新的滚动监听\r\n\t\t\tsafeAddEventListener(container, 'scroll', handleTableScroll);\r\n\t\t});\r\n\r\n\t\t// 同时监听触摸滚动事件（移动设备）\r\n\t\tsafeRemoveEventListener(document, 'touchmove', handleTouchScroll);\r\n\t\tsafeAddEventListener(document, 'touchmove', handleTouchScroll, {\r\n\t\t\tpassive: true\r\n\t\t});\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * 表格滚动处理函数\r\n\t */\r\n\tconst handleTableScroll = () => {\r\n\t\tcanvasPointerEvents.value = 'auto';\r\n\t\t// console.log('2')\r\n\t};\r\n\r\n\t/**\r\n\t * 触摸滚动处理函数（移动设备）\r\n\t */\r\n\tconst handleTouchScroll = () => {\r\n\t\tcanvasPointerEvents.value = 'auto';\r\n\t\t// console.log('2')\r\n\t};\r\n\r\n\t/**\r\n\t * 初始化Canvas\r\n\t */\r\n\tconst initCanvas = async () => {\r\n\t\ttry {\r\n\t\t\tawait nextTick();\r\n\r\n\t\t\t// 确保 DOM 完全加载\r\n\t\t\tif (document.readyState !== 'complete') {\r\n\t\t\t\tawait new Promise(resolve => {\r\n\t\t\t\t\tif (document.readyState === 'complete') {\r\n\t\t\t\t\t\tresolve();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tdocument.addEventListener('DOMContentLoaded', resolve);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tlet canvasEl = null;\r\n\t\t\tlet tempCanvasEl = null;\r\n\r\n\t\t\t// 优先使用传入的 ref\r\n\t\t\tif (drawCanvasRef && drawCanvasRef.value) {\r\n\t\t\t\tcanvasEl = drawCanvasRef.value;\r\n\t\t\t} else {\r\n\t\t\t\t// 备选方案：使用选择器\r\n\t\t\t\tcanvasEl = document.querySelector('.draw-canvas');\r\n\t\t\t}\r\n\r\n\t\t\tif (tempCanvasRef && tempCanvasRef.value) {\r\n\t\t\t\ttempCanvasEl = tempCanvasRef.value;\r\n\t\t\t} else {\r\n\t\t\t\ttempCanvasEl = document.querySelector('.temp-canvas');\r\n\t\t\t}\r\n\r\n\t\t\tif (!canvasEl) {\r\n\t\t\t\tconsole.error('主 Canvas 元素未找到');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// 获取表格容器高度\r\n\t\t\tconst tableContainer = document.querySelector('.numbers-table');\r\n\t\t\tlet containerHeight = 0;\r\n\t\t\tconsole.log(tableContainer.getBoundingClientRect().height)\r\n\t\t\tif (tableContainer) {\r\n\t\t\t\tcontainerHeight = tableContainer.getBoundingClientRect().height;\r\n\t\t\t}\r\n\r\n\t\t\tif (isH5) {\r\n\t\t\t\t// 确保是 Canvas 元素\r\n\t\t\t\tif (canvasEl instanceof HTMLCanvasElement) {\r\n\t\t\t\t\tconsole.log('元素是 Canvas');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.warn('元素不是 Canvas，尝试查找内部的 Canvas');\r\n\r\n\t\t\t\t\t// 尝试在元素内部查找 Canvas\r\n\t\t\t\t\tconst innerCanvas = canvasEl.querySelector('canvas');\r\n\t\t\t\t\tif (innerCanvas) {\r\n\t\t\t\t\t\tconsole.log('在元素内部找到 Canvas:', innerCanvas);\r\n\t\t\t\t\t\tcanvasEl = innerCanvas;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconsole.error('元素内部也没有 Canvas');\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcanvasCtx.value = canvasEl.getContext('2d');\r\n\t\t\t\tdpr.value = window.devicePixelRatio || 1;\r\n\r\n\t\t\t\tcanvasSize.value = {\r\n\t\t\t\t\tw: window.innerWidth,\r\n\t\t\t\t\th: containerHeight || window.innerHeight * 0.7\r\n\t\t\t\t};\r\n\r\n\t\t\t\t// 设置 Canvas 尺寸\r\n\t\t\t\tcanvasEl.style.width = `${canvasSize.value.w}px`;\r\n\t\t\t\tcanvasEl.style.height = `${canvasSize.value.h}px`;\r\n\t\t\t\tcanvasEl.width = canvasSize.value.w * dpr.value;\r\n\t\t\t\tcanvasEl.height = canvasSize.value.h * dpr.value;\r\n\r\n\t\t\t\tif (canvasCtx.value) {\r\n\t\t\t\t\tcanvasCtx.value.scale(dpr.value, dpr.value);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 初始化临时画布\r\n\t\t\t\tif (tempCanvasEl && tempCanvasEl instanceof HTMLCanvasElement) {\r\n\t\t\t\t\ttempCanvasCtx.value = tempCanvasEl.getContext('2d');\r\n\t\t\t\t\ttempCanvasEl.style.width = `${canvasSize.value.w}px`;\r\n\t\t\t\t\ttempCanvasEl.style.height = `${canvasSize.value.h}px`;\r\n\t\t\t\t\ttempCanvasEl.width = canvasSize.value.w * dpr.value;\r\n\t\t\t\t\ttempCanvasEl.height = canvasSize.value.h * dpr.value;\r\n\t\t\t\t\tif (tempCanvasCtx.value) {\r\n\t\t\t\t\t\ttempCanvasCtx.value.scale(dpr.value, dpr.value);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// 初始化主画布\r\n\t\t\t\tconst query = uni.createSelectorQuery();\r\n\t\t\t\tconst res = await new Promise(resolve => {\r\n\t\t\t\t\tquery.select('.draw-canvas')\r\n\t\t\t\t\t\t.fields({\r\n\t\t\t\t\t\t\tnode: true,\r\n\t\t\t\t\t\t\tsize: true\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.exec(rect => resolve(rect[0]));\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (!res || !res.node) {\r\n\t\t\t\t\tconsole.error('Canvas初始化失败');\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst canvas = res.node;\r\n\t\t\t\tcanvasCtx.value = canvas.getContext('2d');\r\n\t\t\t\tconst systemInfo = uni.getSystemInfoSync();\r\n\t\t\t\tdpr.value = systemInfo.pixelRatio || 1;\r\n\r\n\t\t\t\t// 设置画布宽度为窗口宽度，高度为表格容器高度\r\n\t\t\t\tcanvasSize.value = {\r\n\t\t\t\t\tw: systemInfo.windowWidth,\r\n\t\t\t\t\th: containerHeight\r\n\t\t\t\t};\r\n\r\n\t\t\t\tcanvasCtx.value.scale(dpr.value, dpr.value);\r\n\r\n\t\t\t\t// 初始化临时画布\r\n\t\t\t\tconst tempRes = await new Promise(resolve => {\r\n\t\t\t\t\tquery.select('.temp-canvas')\r\n\t\t\t\t\t\t.fields({\r\n\t\t\t\t\t\t\tnode: true,\r\n\t\t\t\t\t\t\tsize: true\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.exec(rect => resolve(rect[0]));\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (tempRes && tempRes.node) {\r\n\t\t\t\t\tconst tempCanvas = tempRes.node;\r\n\t\t\t\t\ttempCanvasCtx.value = tempCanvas.getContext('2d');\r\n\t\t\t\t\ttempCanvas.style.width = canvasSize.value.w + 'px';\r\n\t\t\t\t\ttempCanvas.style.height = canvasSize.value.h + 'px';\r\n\t\t\t\t\ttempCanvas.width = canvasSize.value.w * dpr.value;\r\n\t\t\t\t\ttempCanvas.height = canvasSize.value.h * dpr.value;\r\n\t\t\t\t\ttempCanvasCtx.value.scale(dpr.value, dpr.value);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconsole.log('Canvas 初始化成功');\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Canvas 初始化过程中发生错误:', error);\r\n\t\t}\r\n\t};\r\n\r\n\t// 在模块初始化时设置滚动监听（确保DOM已加载）\r\n\tnextTick().then(() => {\r\n\t\tsetupTableScrollListener();\r\n\t});\r\n\r\n\treturn {\r\n\t\tcurrentMode,\r\n\t\tisDrawing,\r\n\t\tisErasing,\r\n\t\tcanvasPointerEvents,\r\n\t\tstrokeColor,\r\n\t\tlineWidth,\r\n\t\tcanvasCtx,\r\n\t\ttempCanvasCtx,\r\n\t\tcanvasSize,\r\n\t\tdpr,\r\n\t\tcurrentShape,\r\n\t\tshapes,\r\n\t\teraserSize,\r\n\t\tonCanvasStart,\r\n\t\tonCanvasMove,\r\n\t\tonCanvasEnd,\r\n\t\tredraw,\r\n\t\tinitCanvas,\r\n\t\tcheckPointOnNumber,\r\n\t\tisPointInNonDrawableArea,\r\n\t\tcheckPointOnTextLabel,\r\n\t\tperformErase,\r\n\t\tsetupTableScrollListener // 暴露出去以便在需要时手动调用\r\n\t};\r\n}"],"names":["uni","vuex","createSSRApp","App","Pinia.createPinia","Pinia","isH5","ref","coords","nextTick"],"mappings":"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"}