{"version":3,"file":"predict-publish.js","sources":["pages/predict-publish/predict-publish.vue","D:/uniapp/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvcHJlZGljdC1wdWJsaXNoL3ByZWRpY3QtcHVibGlzaC52dWU"],"sourcesContent":["<template>\r\n  <view class=\"publish-container\">\r\n    <!-- 导航栏 -->\r\n    <view class=\"navbar\">\r\n      <view class=\"nav-content\">\r\n        <view class=\"nav-left\" @click=\"goBack\">\r\n          <text class=\"back-arrow\">‹</text>\r\n        </view>\r\n        <text class=\"nav-title\">预测</text>\r\n        <view class=\"nav-right\"></view>\r\n      </view>\r\n    </view>\r\n    \r\n    <!-- 主要内容区域 -->\r\n    <view class=\"main-content\">\r\n      <!-- 我的方案标题 -->\r\n      <view class=\"title-section\">\r\n        <text class=\"title-text\">我的方案</text>\r\n      </view>\r\n      \r\n      <!-- 方案列表 -->\r\n      <view class=\"scheme-list\">\r\n        <view \r\n          class=\"scheme-item\" \r\n          v-for=\"(scheme, index) in schemes\" \r\n          :key=\"index\"\r\n        >\r\n          <view class=\"scheme-content\">\r\n            <view class=\"scheme-header\">\r\n              <text class=\"scheme-name\">{{ scheme.name }}</text>\r\n              <view class=\"scheme-type\">{{ scheme.id }}</view>\r\n            </view>\r\n            <view class=\"scheme-details\">\r\n              <view class=\"scheme-data\">\r\n                <view \r\n                  class=\"position-info\" \r\n                  v-for=\"(info, index) in getSchemeDisplayData(scheme)\" \r\n                  :key=\"index\"\r\n                >\r\n                  {{ info }}\r\n                </view>\r\n              </view>\r\n            </view>\r\n          </view>\r\n        </view>\r\n        \r\n        <!-- 空状态提示 -->\r\n        <view class=\"empty-state\" v-if=\"schemes.length === 0\">\r\n          <text class=\"empty-text\">暂无方案数据</text>\r\n        </view>\r\n      </view>\r\n      \r\n      <!-- 期号信息 -->\r\n      <view class=\"period-info\">\r\n        <text class=\"period-text\">{{ lotteryType ? lotteryType.name : '彩票类型' }} 第{{ getIssueNumber() }}期</text>\r\n        <text class=\"period-status\">{{ issueInfo.status }}</text>\r\n      </view>\r\n      \r\n      <!-- 追帖功能区域 -->\r\n      <view class=\"append-section\" v-if=\"postId || isAppendMode\">\r\n        <view class=\"append-title\">\r\n          <text class=\"append-title-text\">追加内容</text>\r\n          <text class=\"append-post-id\">帖子ID: {{ postId }}</text>\r\n        </view>\r\n        <view class=\"append-info\">\r\n          <text class=\"append-info-text\">将自动追加当前选择的方案到原帖子</text>\r\n        </view>\r\n        <view class=\"append-buttons\">\r\n          <button \r\n            class=\"append-btn\" \r\n            :class=\"{ disabled: isAppending }\"\r\n            @click=\"handleAppendPost\"\r\n          >\r\n            {{ isAppending ? '追加中...' : '追加发帖' }}\r\n          </button>\r\n        </view>\r\n      </view>\r\n    </view>\r\n    \r\n    <!-- 底部按钮区域 -->\r\n    <view class=\"bottom-section\" v-if=\"!isAppendMode\">\r\n      <!-- 警告信息 -->\r\n      <view class=\"warning-section\">\r\n        <text class=\"warning-text\">注:帖子一旦发布,将不能进行修改或删除操作</text>\r\n      </view>\r\n      \r\n      <!-- 操作按钮 -->\r\n      <view class=\"action-buttons\">\r\n        <button class=\"modify-btn\" @click=\"modifyScheme\">修改</button>\r\n        <button class=\"publish-btn\" @click=\"publishScheme\">发布</button>\r\n      </view>\r\n    </view>\r\n    \r\n    <!-- 追帖模式底部提示 -->\r\n    <view class=\"bottom-section\" v-if=\"isAppendMode\">\r\n      <view class=\"warning-section\">\r\n        <text class=\"warning-text\">追帖模式：追加内容到已发布的帖子</text>\r\n      </view>\r\n    </view>\r\n    \r\n  </view>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue'\r\nimport { getAccount } from '@/utils/request.js'\r\nimport { apiPost, apiGetIssueNo, apiPostUpdate, apiPostListQuery } from '@/api/apis.js'\r\n\r\n// 方案数据\r\nconst schemes = ref([])\r\n\r\n// 追帖相关数据\r\nconst postId = ref('') // 当前帖子ID\r\nconst isAppending = ref(false) // 是否正在追帖\r\nconst appendContent = ref('') // 追帖内容\r\nconst isAppendMode = ref(false) // 是否为追帖模式\r\n\r\n// 彩票类型和期号信息\r\nconst lotteryType = ref(null)\r\nconst issueInfo = ref({\r\n  id: null,\r\n  number: null,\r\n  status: '待开奖',\r\n  time: '今天 21:30'\r\n})\r\n\r\n// 请求锁 - 防止重复请求\r\nconst isLoadingIssueInfo = ref(false)\r\nconst isLoadingPostDetails = ref(false)\r\nconst isLoadingUserPosts = ref(false)\r\n\r\n// 格式化方案数据显示（保留原函数以兼容）\r\nconst formatSchemeData = (scheme) => {\r\n  const data = scheme.data\r\n  \r\n  if (scheme.id === '二字现' || scheme.id === '三字现') {\r\n    // 组合类方案\r\n    if (data.combinations && data.combinations.length > 0) {\r\n      return data.combinations.join(',')\r\n    }\r\n    return '未选择'\r\n  } else {\r\n    // 数字类方案 - 详细显示每位信息，包含主攻和重点\r\n    let result = []\r\n    \r\n    // 千位\r\n    if (data.thousands && data.thousands.length > 0) {\r\n      let thousandsInfo = `千位: ${data.thousands.join('')}`\r\n      if (data.thousandsMainAttack && data.thousandsMainAttack.length > 0) {\r\n        thousandsInfo += ` 主攻${data.thousandsMainAttack.join('')}`\r\n      }\r\n      if (data.thousandsKeyPoint && data.thousandsKeyPoint.length > 0) {\r\n        thousandsInfo += ` 重点${data.thousandsKeyPoint.join('')}`\r\n      }\r\n      result.push(thousandsInfo)\r\n    }\r\n    \r\n    // 百位\r\n    if (data.hundreds && data.hundreds.length > 0) {\r\n      let hundredsInfo = `百位: ${data.hundreds.join('')}`\r\n      if (data.hundredsMainAttack && data.hundredsMainAttack.length > 0) {\r\n        hundredsInfo += ` 主攻${data.hundredsMainAttack.join('')}`\r\n      }\r\n      if (data.hundredsKeyPoint && data.hundredsKeyPoint.length > 0) {\r\n        hundredsInfo += ` 重点${data.hundredsKeyPoint.join('')}`\r\n      }\r\n      result.push(hundredsInfo)\r\n    }\r\n    \r\n    // 十位\r\n    if (data.tens && data.tens.length > 0) {\r\n      let tensInfo = `十位: ${data.tens.join('')}`\r\n      if (data.tensMainAttack && data.tensMainAttack.length > 0) {\r\n        tensInfo += ` 主攻${data.tensMainAttack.join('')}`\r\n      }\r\n      if (data.tensKeyPoint && data.tensKeyPoint.length > 0) {\r\n        tensInfo += ` 重点${data.tensKeyPoint.join('')}`\r\n      }\r\n      result.push(tensInfo)\r\n    }\r\n    \r\n    // 个位\r\n    if (data.units && data.units.length > 0) {\r\n      let unitsInfo = `个位: ${data.units.join('')}`\r\n      if (data.unitsMainAttack && data.unitsMainAttack.length > 0) {\r\n        unitsInfo += ` 主攻${data.unitsMainAttack.join('')}`\r\n      }\r\n      if (data.unitsKeyPoint && data.unitsKeyPoint.length > 0) {\r\n        unitsInfo += ` 重点${data.unitsKeyPoint.join('')}`\r\n      }\r\n      result.push(unitsInfo)\r\n    }\r\n    \r\n    return result.length > 0 ? result.join(' | ') : '未选择'\r\n  }\r\n}\r\n\r\n// 获取分行显示的方案数据\r\nconst getSchemeDisplayData = (scheme) => {\r\n  const data = scheme.data\r\n  const result = []\r\n  \r\n  if (scheme.id === '二字现' || scheme.id === '三字现') {\r\n    // 组合类方案\r\n    if (data.combinations && data.combinations.length > 0) {\r\n      result.push(data.combinations.join(','))\r\n    } else {\r\n      result.push('未选择')\r\n    }\r\n  } else {\r\n    // 数字类方案 - 每位信息单独一行\r\n    if (data.thousands && data.thousands.length > 0) {\r\n      let thousandsInfo = `千位: ${data.thousands.join('')}`\r\n      if (data.thousandsMainAttack && data.thousandsMainAttack.length > 0) {\r\n        thousandsInfo += ` 主攻${data.thousandsMainAttack.join('')}`\r\n      }\r\n      if (data.thousandsKeyPoint && data.thousandsKeyPoint.length > 0) {\r\n        thousandsInfo += ` 重点${data.thousandsKeyPoint.join('')}`\r\n      }\r\n      result.push(thousandsInfo)\r\n    }\r\n    \r\n    if (data.hundreds && data.hundreds.length > 0) {\r\n      let hundredsInfo = `百位: ${data.hundreds.join('')}`\r\n      if (data.hundredsMainAttack && data.hundredsMainAttack.length > 0) {\r\n        hundredsInfo += ` 主攻${data.hundredsMainAttack.join('')}`\r\n      }\r\n      if (data.hundredsKeyPoint && data.hundredsKeyPoint.length > 0) {\r\n        hundredsInfo += ` 重点${data.hundredsKeyPoint.join('')}`\r\n      }\r\n      result.push(hundredsInfo)\r\n    }\r\n    \r\n    if (data.tens && data.tens.length > 0) {\r\n      let tensInfo = `十位: ${data.tens.join('')}`\r\n      if (data.tensMainAttack && data.tensMainAttack.length > 0) {\r\n        tensInfo += ` 主攻${data.tensMainAttack.join('')}`\r\n      }\r\n      if (data.tensKeyPoint && data.tensKeyPoint.length > 0) {\r\n        tensInfo += ` 重点${data.tensKeyPoint.join('')}`\r\n      }\r\n      result.push(tensInfo)\r\n    }\r\n    \r\n    if (data.units && data.units.length > 0) {\r\n      let unitsInfo = `个位: ${data.units.join('')}`\r\n      if (data.unitsMainAttack && data.unitsMainAttack.length > 0) {\r\n        unitsInfo += ` 主攻${data.unitsMainAttack.join('')}`\r\n      }\r\n      if (data.unitsKeyPoint && data.unitsKeyPoint.length > 0) {\r\n        unitsInfo += ` 重点${data.unitsKeyPoint.join('')}`\r\n      }\r\n      result.push(unitsInfo)\r\n    }\r\n    \r\n    if (result.length === 0) {\r\n      result.push('未选择')\r\n    }\r\n  }\r\n  \r\n  return result\r\n}\r\n\r\n// 修改方案\r\nconst modifyScheme = () => {\r\n  // 将当前方案数据传递回上级页面进行修改\r\n  uni.navigateBack({\r\n    delta: 1,\r\n    // 通过事件总线或全局状态传递数据\r\n    success: () => {\r\n      // 通知上级页面有数据需要修改\r\n      uni.$emit('modifySchemes', schemes.value)\r\n    }\r\n  })\r\n}\r\n\r\n// 发布方案\r\nconst publishScheme = async () => {\r\n  uni.showModal({\r\n    title: '确认发布',\r\n    content: '确定要发布这些方案吗？发布后将无法修改或删除。',\r\n    success: async (res) => {\r\n      if (res.confirm) {\r\n        await handlePublish()\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\n// 测试追帖功能\r\nconst testAppendFunction = () => {\r\n  console.log('=== 测试追帖功能 ===')\r\n  console.log('当前帖子ID:', postId.value)\r\n  console.log('追帖模式:', isAppendMode.value)\r\n  \r\n  if (!postId.value) {\r\n    uni.showModal({\r\n      title: '测试结果',\r\n      content: '帖子ID缺失，无法测试追帖功能',\r\n      showCancel: false\r\n    })\r\n    return\r\n  }\r\n  \r\n  uni.showModal({\r\n    title: '测试追帖功能',\r\n    content: `帖子ID: ${postId.value}\\n方案数量: ${schemes.value.length}\\n\\n是否执行追帖？`,\r\n    confirmText: '执行追帖',\r\n    cancelText: '取消',\r\n    success: (res) => {\r\n      if (res.confirm) {\r\n        handleAppendPost()\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\n// 处理追帖逻辑\r\nconst handleAppendPost = async () => {\r\n  if (!postId.value) {\r\n    uni.showToast({\r\n      title: '帖子ID缺失',\r\n      icon: 'none'\r\n    })\r\n    return\r\n  }\r\n  \r\n  try {\r\n    isAppending.value = true\r\n    uni.showLoading({\r\n      title: '追加中...'\r\n    })\r\n    \r\n    // 自动生成追加内容（包含原帖子内容）\r\n    const appendText = await generateAppendContent()\r\n    \r\n    // 调用追帖接口 - 只传递必要的参数，不包含pimg\r\n    const response = await apiPostUpdate({\r\n      id: postId.value,\r\n      content: appendText\r\n    })\r\n    \r\n    uni.hideLoading()\r\n    \r\n    if (response.code === 200) {\r\n      uni.showToast({\r\n        title: '追加成功',\r\n        icon: 'success'\r\n      })\r\n      \r\n      // 清理追帖相关数据\r\n      uni.removeStorageSync('appendPostData')\r\n      uni.removeStorageSync('currentAppendPostData')\r\n      uni.removeStorageSync('appendModeTipShown')\r\n      \r\n      // 延迟返回论坛页面\r\n      setTimeout(() => {\r\n        uni.reLaunch({\r\n          url: '/pages/forum/forum'\r\n        })\r\n      }, 1500)\r\n    } else {\r\n      uni.showToast({\r\n        title: response.msg || '追加失败',\r\n        icon: 'none'\r\n      })\r\n    }\r\n    \r\n  } catch (error) {\r\n    uni.hideLoading()\r\n    uni.showToast({\r\n      title: '追加失败，请重试',\r\n      icon: 'none'\r\n    })\r\n  } finally {\r\n    isAppending.value = false\r\n  }\r\n}\r\n\r\n// 生成追加内容\r\nconst generateAppendContent = async () => {\r\n  try {\r\n    // 首先获取原帖子的内容\r\n    let originalContent = ''\r\n    \r\n    if (postId.value) {\r\n      try {\r\n        // 尝试通过帖子列表查询获取原帖子内容\r\n        const response = await apiPostListQuery({\r\n          page: 1,\r\n          size: 50,\r\n          tname: currentLotteryType.value?.name || '预测方案'\r\n        })\r\n        \r\n        if (response.code === 200 && response.data && response.data.records && Array.isArray(response.data.records)) {\r\n          // 在查询结果中查找目标帖子\r\n          const targetPost = response.data.records.find(post => post.id == postId.value)\r\n          \r\n          if (targetPost) {\r\n            originalContent = targetPost.content || ''\r\n          }\r\n        }\r\n      } catch (error) {\r\n        // 如果API查询失败，尝试从本地存储获取\r\n        const appendData = uni.getStorageSync('currentAppendPostData')\r\n        if (appendData && appendData.postContent) {\r\n          originalContent = appendData.postContent\r\n        }\r\n      }\r\n    }\r\n    \r\n    // 生成追加内容\r\n    let appendContent = '\\n\\n--- 追加内容 ---\\n'\r\n    appendContent += `追加时间: ${new Date().toLocaleString()}\\n`\r\n    \r\n    if (schemes.value.length > 0) {\r\n      appendContent += '\\n追加方案:\\n'\r\n      schemes.value.forEach((scheme, index) => {\r\n        appendContent += `${index + 1}. [${scheme.id}]\\n`\r\n        \r\n        const displayData = getSchemeDisplayData(scheme)\r\n        displayData.forEach(info => {\r\n          appendContent += `   ${info}\\n`\r\n        })\r\n      })\r\n    } else {\r\n      appendContent += '\\n追加内容: 方案数据\\n'\r\n    }\r\n    \r\n    // 将追加内容添加到原内容后面\r\n    const finalContent = originalContent + appendContent\r\n    \r\n    return finalContent\r\n    \r\n  } catch (error) {\r\n    // 如果获取原内容失败，至少返回追加内容\r\n    let appendContent = '\\n\\n--- 追加内容 ---\\n'\r\n    appendContent += `追加时间: ${new Date().toLocaleString()}\\n`\r\n    \r\n    if (schemes.value.length > 0) {\r\n      appendContent += '\\n追加方案:\\n'\r\n      schemes.value.forEach((scheme, index) => {\r\n        appendContent += `${index + 1}. [${scheme.id}]\\n`\r\n        \r\n        const displayData = getSchemeDisplayData(scheme)\r\n        displayData.forEach(info => {\r\n          appendContent += `   ${info}\\n`\r\n        })\r\n      })\r\n    }\r\n    \r\n    return appendContent\r\n  }\r\n}\r\n\r\n// 处理发布逻辑\r\nconst handlePublish = async () => {\r\n  try {\r\n    uni.showLoading({\r\n      title: '发布中...'\r\n    })\r\n    \r\n    // 准备发帖数据\r\n    const postData = {\r\n      tname: lotteryType.value ? lotteryType.value.name : '预测方案', // 彩票名称\r\n      issueno: getIssueNumber(), // 期号 - 使用统一的期号获取函数\r\n      content: generatePostContent(), // 发帖内容\r\n      account: getAccount() || '', // 账号\r\n      pimg: '', // 预测帖不需要图片\r\n      flag: true // 无需审核\r\n    }\r\n    \r\n    console.log('发帖数据:', postData)\r\n    \r\n    const response = await apiPost(postData)\r\n    \r\n    uni.hideLoading()\r\n    \r\n    if (response.code === 200) {\r\n      // 保存帖子ID到本地存储，用于后续追帖\r\n      if (response.data && response.data.id) {\r\n        postId.value = response.data.id\r\n        uni.setStorageSync('currentPostId', response.data.id)\r\n        \r\n        // 保存今天已发布的方案和帖子ID映射\r\n        savePublishedSchemeData(response.data.id)\r\n      }\r\n      \r\n        uni.showToast({\r\n          title: '发布成功',\r\n          icon: 'success'\r\n        })\r\n      \r\n      // 清除本地存储的方案数据\r\n      uni.removeStorageSync('predict_schemes_data')\r\n      \r\n      // 延迟返回论坛页面\r\n        setTimeout(() => {\r\n        uni.reLaunch({\r\n          url: '/pages/forum/forum'\r\n        })\r\n        }, 1500)\r\n    } else {\r\n      uni.showToast({\r\n        title: response.msg || '发布失败',\r\n        icon: 'none'\r\n      })\r\n    }\r\n    \r\n  } catch (error) {\r\n    uni.hideLoading()\r\n    uni.showToast({\r\n      title: '发布失败，请重试',\r\n      icon: 'none'\r\n    })\r\n  }\r\n}\r\n\r\n// 获取期号显示\r\nconst getIssueNumber = () => {\r\n  return issueInfo.value.number || issueInfo.value.id || '--'\r\n}\r\n\r\n\r\n// 加载期号信息\r\nconst loadIssueInfo = async () => {\r\n  // 防止重复请求\r\n  if (isLoadingIssueInfo.value) {\r\n    console.log('正在加载期号信息，跳过重复请求')\r\n    return\r\n  }\r\n  \r\n  try {\r\n    isLoadingIssueInfo.value = true\r\n    if (!lotteryType.value || !lotteryType.value.id) {\r\n      return\r\n    }\r\n    \r\n    uni.showLoading({ title: '加载期号中...' })\r\n    \r\n    const response = await apiGetIssueNo({ tname: lotteryType.value.name })\r\n    \r\n    uni.hideLoading()\r\n    \r\n    if (response.code === 200 && response.data !== null && response.data !== undefined) {\r\n      let issueNumber = null\r\n      let issueStatus = '待开奖'\r\n      let issueTime = '今天 21:30'\r\n      \r\n      if (typeof response.data === 'number' || typeof response.data === 'string') {\r\n        issueNumber = response.data.toString()\r\n      } else if (typeof response.data === 'object') {\r\n        issueNumber = response.data.issueno || response.data.number || response.data.id\r\n        issueStatus = response.data.status || '待开奖'\r\n        issueTime = response.data.time || '今天 21:30'\r\n      }\r\n      \r\n      issueInfo.value = {\r\n        id: issueNumber,\r\n        number: issueNumber,\r\n        status: issueStatus,\r\n        time: issueTime\r\n      }\r\n      \r\n      uni.showToast({ title: `期号加载成功: ${issueNumber}`, icon: 'success' })\r\n    } else {\r\n      uni.showToast({ title: '期号数据为空', icon: 'none' })\r\n    }\r\n  } catch (error) {\r\n    uni.hideLoading()\r\n    console.error('加载期号信息失败:', error)\r\n    uni.showToast({ title: '期号加载异常', icon: 'none' })\r\n  } finally {\r\n    isLoadingIssueInfo.value = false\r\n  }\r\n}\r\n\r\n// 加载追帖模式下的方案数据\r\nconst loadSchemeForAppend = async (schemeId) => {\r\n  try {\r\n    console.log('=== 加载追帖方案数据 ===')\r\n    console.log('方案ID:', schemeId)\r\n    \r\n    const today = new Date().toDateString()\r\n    const publishedPosts = uni.getStorageSync(`publishedPosts_${today}`) || {}\r\n    \r\n    console.log('已发布的帖子映射:', publishedPosts)\r\n    \r\n    // 获取该方案对应的帖子ID\r\n    const schemePostId = publishedPosts[schemeId]\r\n    if (schemePostId) {\r\n      postId.value = schemePostId\r\n      console.log(`加载方案 ${schemeId} 对应的帖子ID:`, schemePostId)\r\n      \r\n      // 从接口获取帖子详细信息\r\n      await loadPostDetails(schemePostId)\r\n    } else {\r\n      console.log(`未找到方案 ${schemeId} 对应的帖子ID`)\r\n      \r\n      // 尝试从接口获取用户已发布的帖子\r\n      await loadUserPublishedPosts(schemeId)\r\n    }\r\n    \r\n  } catch (error) {\r\n    console.error('加载追帖方案数据失败:', error)\r\n  }\r\n}\r\n\r\n// 从接口获取帖子详细信息\r\nconst loadPostDetails = async (postId) => {\r\n  // 防止重复请求\r\n  if (isLoadingPostDetails.value) {\r\n    console.log('正在加载帖子详情，跳过重复请求')\r\n    return\r\n  }\r\n  \r\n  try {\r\n    isLoadingPostDetails.value = true\r\n    console.log('=== 获取帖子详细信息 ===')\r\n    console.log('帖子ID:', postId)\r\n    \r\n    // 调用帖子列表查询接口获取帖子详情\r\n    const response = await apiPostListQuery({\r\n      page: 1,\r\n      size: 1,\r\n      id: postId\r\n    })\r\n    \r\n    if (response.code === 200 && response.data && response.data.records && response.data.records.length > 0) {\r\n      const post = response.data.records[0]\r\n      console.log('帖子详情:', post)\r\n      \r\n      // 从帖子内容中解析方案数据\r\n      if (post.content) {\r\n        parseSchemeFromPostContent(post.content)\r\n      }\r\n    }\r\n    \r\n  } catch (error) {\r\n    console.error('获取帖子详情失败:', error)\r\n  } finally {\r\n    isLoadingPostDetails.value = false\r\n  }\r\n}\r\n\r\n// 从接口获取用户已发布的帖子\r\nconst loadUserPublishedPosts = async (schemeId) => {\r\n  // 防止重复请求\r\n  if (isLoadingUserPosts.value) {\r\n    console.log('正在加载用户帖子，跳过重复请求')\r\n    return\r\n  }\r\n  \r\n  try {\r\n    isLoadingUserPosts.value = true\r\n    console.log('=== 获取用户已发布帖子 ===')\r\n    console.log('方案ID:', schemeId)\r\n    \r\n    const response = await apiPostListQuery({\r\n      page: 1,\r\n      size: 20,\r\n      account: uni.getStorageSync('account') || ''\r\n    })\r\n    \r\n    if (response.code === 200 && response.data && response.data.records) {\r\n      // 查找包含指定方案的帖子\r\n      const targetPost = response.data.records.find(post => \r\n        post.content && post.content.includes(schemeId)\r\n      )\r\n      \r\n      if (targetPost) {\r\n        postId.value = targetPost.id\r\n        console.log(`找到方案 ${schemeId} 对应的帖子:`, targetPost.id)\r\n        \r\n        // 解析方案数据\r\n        parseSchemeFromPostContent(targetPost.content)\r\n      } else {\r\n        console.log(`未找到包含方案 ${schemeId} 的帖子`)\r\n      }\r\n    }\r\n    \r\n  } catch (error) {\r\n    console.error('获取用户已发布帖子失败:', error)\r\n  } finally {\r\n    isLoadingUserPosts.value = false\r\n  }\r\n}\r\n\r\n// 从帖子内容中解析方案数据\r\nconst parseSchemeFromPostContent = (content) => {\r\n  try {\r\n    console.log('=== 解析帖子内容 ===')\r\n    console.log('帖子内容:', content)\r\n    \r\n    // 这里可以根据帖子内容的格式来解析方案数据\r\n    // 暂时使用本地存储的方案数据作为备用\r\n    const savedSchemesData = uni.getStorageSync('predict_schemes_data')\r\n    console.log('本地存储的方案数据:', savedSchemesData)\r\n    \r\n    if (savedSchemesData && savedSchemesData.schemeData) {\r\n      // 尝试从本地存储中找到对应的方案数据\r\n      const schemeKeys = Object.keys(savedSchemesData.schemeData)\r\n      const matchingScheme = schemeKeys.find(key => content.includes(key))\r\n      \r\n      if (matchingScheme) {\r\n        const schemeData = savedSchemesData.schemeData[matchingScheme]\r\n        const schemeObj = {\r\n          id: matchingScheme,\r\n          name: matchingScheme,\r\n          data: schemeData\r\n        }\r\n        schemes.value = [schemeObj]\r\n        console.log('解析出的方案数据:', schemeObj)\r\n      }\r\n    }\r\n    \r\n  } catch (error) {\r\n    console.error('解析帖子内容失败:', error)\r\n  }\r\n}\r\n\r\n// 保存已发布的方案数据\r\nconst savePublishedSchemeData = (postId) => {\r\n  try {\r\n    const today = new Date().toDateString()\r\n    \r\n    // 获取今天已发布的方案列表\r\n    const publishedSchemes = uni.getStorageSync(`publishedSchemes_${today}`) || []\r\n    \r\n    // 获取今天已发布的帖子ID映射\r\n    const publishedPosts = uni.getStorageSync(`publishedPosts_${today}`) || {}\r\n    \r\n    // 遍历当前方案，记录已发布的方案\r\n    schemes.value.forEach(scheme => {\r\n      const schemeId = scheme.id\r\n      \r\n      // 如果方案还没有被标记为已发布，则添加\r\n      if (!publishedSchemes.includes(schemeId)) {\r\n        publishedSchemes.push(schemeId)\r\n      }\r\n      \r\n      // 保存方案对应的帖子ID\r\n      publishedPosts[schemeId] = postId\r\n    })\r\n    \r\n    // 保存到本地存储\r\n    uni.setStorageSync(`publishedSchemes_${today}`, publishedSchemes)\r\n    uni.setStorageSync(`publishedPosts_${today}`, publishedPosts)\r\n    \r\n    console.log('已保存发布数据:', {\r\n      publishedSchemes,\r\n      publishedPosts,\r\n      postId\r\n    })\r\n    \r\n  } catch (error) {\r\n    console.error('保存已发布方案数据失败:', error)\r\n  }\r\n}\r\n\r\n// 生成发帖内容\r\nconst generatePostContent = () => {\r\n  if (schemes.value.length === 0) {\r\n    return '暂无方案数据'\r\n  }\r\n  \r\n  let content = '【预测方案】\\n\\n'\r\n  \r\n  schemes.value.forEach((scheme, index) => {\r\n    content += `${index + 1}. ${scheme.name} (${scheme.id})\\n`\r\n    \r\n    const displayData = getSchemeDisplayData(scheme)\r\n    displayData.forEach(info => {\r\n      content += `   ${info}\\n`\r\n    })\r\n    content += '\\n'\r\n  })\r\n  \r\n      content += `期号: 第${getIssueNumber()}期\\n`\r\n  content += `发布时间: ${new Date().toLocaleString()}`\r\n  \r\n  return content\r\n}\r\n\r\n// 返回\r\nconst goBack = () => {\r\n  uni.showModal({\r\n    title: '提示',\r\n    content: '返回会清空内容,确定返回吗?',\r\n    confirmText: '确定',\r\n    cancelText: '取消',\r\n    confirmColor: '#ff4757',\r\n    success: (res) => {\r\n      if (res.confirm) {\r\n        // 清除本地存储的方案数据\r\n        try {\r\n          uni.removeStorageSync('predict_schemes_data')\r\n        } catch (error) {\r\n          console.error('清除本地存储失败:', error)\r\n        }\r\n        \r\n        // 点击确定，返回论坛页面\r\n        uni.reLaunch({\r\n          url: '/pages/forum/forum'\r\n        })\r\n      }\r\n      // 点击取消不做任何操作\r\n    }\r\n  })\r\n}\r\n\r\n// 页面加载时获取传递的方案数据\r\nonMounted(() => {\r\n  // 获取页面参数\r\n  const pages = getCurrentPages()\r\n  const currentPage = pages[pages.length - 1]\r\n  const options = currentPage.options\r\n  \r\n  console.log('=== 页面加载调试信息 ===')\r\n  console.log('页面参数:', options)\r\n  \r\n  // 检查是否有帖子ID（用于追帖功能）\r\n  if (options.postId) {\r\n    postId.value = options.postId\r\n    uni.setStorageSync('currentPostId', options.postId)\r\n    console.log('接收到帖子ID，进入追帖模式:', options.postId)\r\n    \r\n    // 进入追帖模式，隐藏发帖相关功能\r\n    isAppendMode.value = true\r\n    console.log('追帖模式已设置:', isAppendMode.value)\r\n    \r\n    // 如果有schemeId，加载对应的方案数据\r\n    if (options.schemeId) {\r\n      console.log('加载方案数据:', options.schemeId)\r\n      loadSchemeForAppend(options.schemeId)\r\n    }\r\n  } else {\r\n    // 从本地存储获取帖子ID - 只有在明确进入追帖模式时才设置\r\n    const savedPostId = uni.getStorageSync('currentPostId')\r\n    if (savedPostId) {\r\n      // 检查是否真的是追帖模式（通过检查是否有追帖数据）\r\n      const appendData = uni.getStorageSync('appendPostData')\r\n      if (appendData && appendData.postId === savedPostId) {\r\n        postId.value = savedPostId\r\n        isAppendMode.value = true\r\n        console.log('从本地存储恢复追帖模式:', savedPostId)\r\n      } else {\r\n        // 清除可能残留的帖子ID，确保是新帖模式\r\n        uni.removeStorageSync('currentPostId')\r\n        console.log('清除残留的帖子ID，确保新帖模式')\r\n      }\r\n    }\r\n  }\r\n  \r\n  console.log('最终状态 - 帖子ID:', postId.value, '追帖模式:', isAppendMode.value)\r\n  \r\n  if (options.data) {\r\n    try {\r\n      const publishData = JSON.parse(decodeURIComponent(options.data))\r\n      \r\n      schemes.value = publishData.schemes || []\r\n      lotteryType.value = publishData.lotteryType || null\r\n      issueInfo.value = publishData.issueInfo || {\r\n        id: null,\r\n        number: null,\r\n        status: '待开奖',\r\n        time: '今天 21:30'\r\n      }\r\n      \r\n      // 如果期号信息为空或无效，主动获取期号\r\n      if (!issueInfo.value.number && !issueInfo.value.id) {\r\n        loadIssueInfo()\r\n      }\r\n    } catch (error) {\r\n      uni.showToast({\r\n        title: '数据解析失败',\r\n        icon: 'none'\r\n      })\r\n    }\r\n  } else if (options.schemes) {\r\n    // 兼容旧的URL参数格式\r\n    try {\r\n      const decodedSchemes = decodeURIComponent(options.schemes)\r\n      schemes.value = JSON.parse(decodedSchemes)\r\n    } catch (error) {\r\n      uni.showToast({\r\n        title: '数据解析失败',\r\n        icon: 'none'\r\n      })\r\n    }\r\n  } else {\r\n    // 如果没有接收到数据，显示空状态\r\n    schemes.value = []\r\n    uni.showToast({\r\n      title: '没有方案数据',\r\n      icon: 'none'\r\n    })\r\n  }\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.publish-container {\r\n  min-height: 100vh;\r\n  background-color: #f5f5f5;\r\n}\r\n\r\n/* 导航栏 */\r\n.navbar {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  height: 88rpx;\r\n  background-color: #28B389;\r\n  z-index: 999;\r\n}\r\n\r\n.nav-content {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  height: 100%;\r\n  padding: 0 30rpx;\r\n}\r\n\r\n.nav-left, .nav-right {\r\n  width: 60rpx;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.back-arrow {\r\n  font-size: 40rpx;\r\n  color: #fff;\r\n  font-weight: bold;\r\n}\r\n\r\n.nav-title {\r\n  font-size: 36rpx;\r\n  font-weight: 600;\r\n  color: #fff;\r\n}\r\n\r\n/* 主要内容区域 */\r\n.main-content {\r\n  padding-top: 88rpx;\r\n  padding-bottom: 200rpx; /* 为底部按钮留出空间 */\r\n  padding-left: 30rpx;\r\n  padding-right: 30rpx;\r\n}\r\n\r\n/* 标题区域 */\r\n.title-section {\r\n  margin-bottom: 30rpx;\r\n}\r\n\r\n.title-text {\r\n  font-size: 32rpx;\r\n  font-weight: 600;\r\n  color: #333;\r\n}\r\n\r\n/* 方案列表 */\r\n.scheme-list {\r\n  margin-bottom: 40rpx;\r\n}\r\n\r\n.scheme-item {\r\n  background-color: #fff;\r\n  border-radius: 15rpx;\r\n  margin-bottom: 20rpx;\r\n  padding: 30rpx;\r\n  box-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.scheme-content {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 15rpx;\r\n}\r\n\r\n.scheme-header {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  padding-bottom: 10rpx;\r\n  border-bottom: 1rpx solid #f0f0f0;\r\n}\r\n\r\n.scheme-name {\r\n  font-size: 32rpx;\r\n  font-weight: 600;\r\n  color: #ff4757;\r\n}\r\n\r\n.scheme-type {\r\n  background-color: #28B389;\r\n  color: #fff;\r\n  padding: 8rpx 16rpx;\r\n  border-radius: 20rpx;\r\n  font-size: 22rpx;\r\n  font-weight: 500;\r\n}\r\n\r\n.scheme-details {\r\n  padding: 10rpx 0;\r\n}\r\n\r\n.scheme-data {\r\n  background-color: #f8f9fa;\r\n  padding: 15rpx;\r\n  border-radius: 10rpx;\r\n  border-left: 4rpx solid #28B389;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8rpx;\r\n}\r\n\r\n.position-info {\r\n  font-size: 28rpx;\r\n  color: #333;\r\n  line-height: 1.4;\r\n  word-wrap: break-word;\r\n  word-break: break-all;\r\n}\r\n\r\n/* 空状态样式 */\r\n.empty-state {\r\n  text-align: center;\r\n  padding: 60rpx 30rpx;\r\n}\r\n\r\n.empty-text {\r\n  font-size: 28rpx;\r\n  color: #999;\r\n}\r\n\r\n\r\n/* 期号信息 */\r\n.period-info {\r\n  text-align: center;\r\n  margin-bottom: 30rpx;\r\n}\r\n\r\n.period-text {\r\n  font-size: 24rpx;\r\n  color: #999;\r\n  margin-bottom: 8rpx;\r\n}\r\n\r\n.period-status {\r\n  font-size: 22rpx;\r\n  color: #ff4757;\r\n}\r\n\r\n/* 底部区域 */\r\n.bottom-section {\r\n  position: fixed;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  background-color: #fff;\r\n  padding: 20rpx 30rpx;\r\n  box-shadow: 0 -2rpx 10rpx rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n/* 警告信息 */\r\n.warning-section {\r\n  margin-bottom: 20rpx;\r\n  text-align: center;\r\n}\r\n\r\n.warning-text {\r\n  font-size: 24rpx;\r\n  color: #ff4757;\r\n}\r\n\r\n/* 操作按钮 */\r\n.action-buttons {\r\n  display: flex;\r\n  gap: 20rpx;\r\n}\r\n\r\n.modify-btn, .publish-btn {\r\n  flex: 1;\r\n  height: 80rpx;\r\n  border-radius: 40rpx;\r\n  font-size: 28rpx;\r\n  font-weight: 500;\r\n  border: none;\r\n}\r\n\r\n.modify-btn {\r\n  background-color: #f0f0f0;\r\n  color: #666;\r\n}\r\n\r\n.publish-btn {\r\n  background-color: #ff4757;\r\n  color: #fff;\r\n}\r\n\r\n/* 追帖功能样式 */\r\n.append-section {\r\n  margin-top: 40rpx;\r\n  background-color: #fff;\r\n  border-radius: 15rpx;\r\n  padding: 30rpx;\r\n  box-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.append-title {\r\n  margin-bottom: 20rpx;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 10rpx;\r\n}\r\n\r\n.append-title-text {\r\n  font-size: 30rpx;\r\n  font-weight: 600;\r\n  color: #333;\r\n}\r\n\r\n.append-post-id {\r\n  font-size: 24rpx;\r\n  color: #666;\r\n  background-color: #f0f0f0;\r\n  padding: 8rpx 16rpx;\r\n  border-radius: 20rpx;\r\n  align-self: flex-start;\r\n}\r\n\r\n.append-info {\r\n  margin: 20rpx 0;\r\n  padding: 20rpx;\r\n  background-color: #f8f9fa;\r\n  border-radius: 10rpx;\r\n  text-align: center;\r\n}\r\n\r\n.append-info-text {\r\n  font-size: 26rpx;\r\n  color: #666;\r\n}\r\n\r\n.append-buttons {\r\n  display: flex;\r\n  justify-content: center;\r\n  gap: 20rpx;\r\n  margin-top: 30rpx;\r\n}\r\n\r\n.append-btn {\r\n  width: 200rpx;\r\n  height: 70rpx;\r\n  background-color: #28B389;\r\n  color: #fff;\r\n  border: none;\r\n  border-radius: 35rpx;\r\n  font-size: 26rpx;\r\n  font-weight: 500;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.append-btn.disabled {\r\n  background-color: #ccc;\r\n  color: #999;\r\n}\r\n\r\n</style>\r\n\r\n","import MiniProgramPage from 'C:/Users/Administrator/Desktop/caimixcx/pages/predict-publish/predict-publish.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uni","apiPostUpdate","apiPostListQuery","getAccount","apiPost","apiGetIssueNo","postId","onMounted"],"mappings":"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"}