{"version":3,"file":"predict-publish.js","sources":["pages/predict-publish/predict-publish.vue","D:/uniapp/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvcHJlZGljdC1wdWJsaXNoL3ByZWRpY3QtcHVibGlzaC52dWU"],"sourcesContent":["<template>\n  <view class=\"publish-container\">\n    <!-- 导航栏 -->\n    <view class=\"navbar\">\n      <view class=\"nav-content\">\n        <view class=\"nav-left\" @click=\"goBack\">\n          <text class=\"back-arrow\">‹</text>\n        </view>\n        <text class=\"nav-title\">预测</text>\n        <view class=\"nav-right\"></view>\n      </view>\n    </view>\n    \n    <!-- 主要内容区域 -->\n    <view class=\"main-content\">\n      <!-- 我的方案标题 -->\n      <view class=\"title-section\">\n        <text class=\"title-text\">我的方案</text>\n      </view>\n      \n      <!-- 方案列表 -->\n      <view class=\"scheme-list\">\n        <view \n          class=\"scheme-item\" \n          v-for=\"(scheme, index) in schemes\" \n          :key=\"index\"\n        >\n          <view class=\"scheme-content\">\n            <view class=\"scheme-header\">\n              <text class=\"scheme-name\">{{ scheme.name }}</text>\n              <view class=\"scheme-type\">{{ scheme.id }}</view>\n            </view>\n            <view class=\"scheme-details\">\n              <view class=\"scheme-data\">\n                <view \n                  class=\"position-info\" \n                  v-for=\"(info, index) in getSchemeDisplayData(scheme)\" \n                  :key=\"index\"\n                >\n                  {{ info }}\n                </view>\n              </view>\n            </view>\n          </view>\n        </view>\n        \n        <!-- 空状态提示 -->\n        <view class=\"empty-state\" v-if=\"schemes.length === 0\">\n          <text class=\"empty-text\">暂无方案数据</text>\n        </view>\n      </view>\n      \n      <!-- 期号信息 -->\n      <view class=\"period-info\">\n        <text class=\"period-text\">{{ lotteryType ? lotteryType.name : '彩票类型' }} 第{{ getIssueNumber() }}期</text>\n        <text class=\"period-status\">{{ issueInfo.status }}</text>\n      </view>\n      \n      <!-- 追帖功能区域 -->\n      <view class=\"append-section\" v-if=\"postId || isAppendMode\">\n        <view class=\"append-title\">\n          <text class=\"append-title-text\">追加内容</text>\n          <text class=\"append-post-id\">帖子ID: {{ postId }}</text>\n        </view>\n        <view class=\"append-info\">\n          <text class=\"append-info-text\">将自动追加当前选择的方案到原帖子</text>\n        </view>\n        <view class=\"append-buttons\">\n          <button \n            class=\"append-btn\" \n            :class=\"{ disabled: isAppending }\"\n            @click=\"handleAppendPost\"\n          >\n            {{ isAppending ? '追加中...' : '追加发帖' }}\n          </button>\n        </view>\n      </view>\n    </view>\n    \n    <!-- 底部按钮区域 -->\n    <view class=\"bottom-section\" v-if=\"!isAppendMode\">\n      <!-- 警告信息 -->\n      <view class=\"warning-section\">\n        <text class=\"warning-text\">注:帖子一旦发布,将不能进行修改或删除操作</text>\n      </view>\n      \n      <!-- 操作按钮 -->\n      <view class=\"action-buttons\">\n        <button class=\"modify-btn\" @click=\"modifyScheme\">修改</button>\n        <button class=\"publish-btn\" @click=\"publishScheme\">发布</button>\n      </view>\n    </view>\n    \n    <!-- 追帖模式底部提示 -->\n    <view class=\"bottom-section\" v-if=\"isAppendMode\">\n      <view class=\"warning-section\">\n        <text class=\"warning-text\">追帖模式：追加内容到已发布的帖子</text>\n      </view>\n    </view>\n    \n  </view>\n</template>\n\n<script setup>\nimport { ref, onMounted } from 'vue'\nimport { getAccount } from '@/utils/request.js'\nimport { apiPost, apiGetIssueNo, apiPostUpdate, apiPostListQuery } from '@/api/apis.js'\n\n// 方案数据\nconst schemes = ref([])\n\n// 追帖相关数据\nconst postId = ref('') // 当前帖子ID\nconst isAppending = ref(false) // 是否正在追帖\nconst appendContent = ref('') // 追帖内容\nconst isAppendMode = ref(false) // 是否为追帖模式\n\n// 彩票类型和期号信息\nconst lotteryType = ref(null)\nconst issueInfo = ref({\n  id: null,\n  number: null,\n  status: '待开奖',\n  time: '今天 21:30'\n})\n\n// 请求锁 - 防止重复请求\nconst isLoadingIssueInfo = ref(false)\nconst isLoadingPostDetails = ref(false)\nconst isLoadingUserPosts = ref(false)\n\n// 格式化方案数据显示（保留原函数以兼容）\nconst formatSchemeData = (scheme) => {\n  const data = scheme.data\n  \n  if (scheme.id === '二字现' || scheme.id === '三字现') {\n    // 组合类方案\n    if (data.combinations && data.combinations.length > 0) {\n      return data.combinations.join(',')\n    }\n    return '未选择'\n  } else {\n    // 数字类方案 - 详细显示每位信息，包含主攻和重点\n    let result = []\n    \n    // 千位\n    if (data.thousands && data.thousands.length > 0) {\n      let thousandsInfo = `千位: ${data.thousands.join('')}`\n      if (data.thousandsMainAttack && data.thousandsMainAttack.length > 0) {\n        thousandsInfo += ` 主攻${data.thousandsMainAttack.join('')}`\n      }\n      if (data.thousandsKeyPoint && data.thousandsKeyPoint.length > 0) {\n        thousandsInfo += ` 重点${data.thousandsKeyPoint.join('')}`\n      }\n      result.push(thousandsInfo)\n    }\n    \n    // 百位\n    if (data.hundreds && data.hundreds.length > 0) {\n      let hundredsInfo = `百位: ${data.hundreds.join('')}`\n      if (data.hundredsMainAttack && data.hundredsMainAttack.length > 0) {\n        hundredsInfo += ` 主攻${data.hundredsMainAttack.join('')}`\n      }\n      if (data.hundredsKeyPoint && data.hundredsKeyPoint.length > 0) {\n        hundredsInfo += ` 重点${data.hundredsKeyPoint.join('')}`\n      }\n      result.push(hundredsInfo)\n    }\n    \n    // 十位\n    if (data.tens && data.tens.length > 0) {\n      let tensInfo = `十位: ${data.tens.join('')}`\n      if (data.tensMainAttack && data.tensMainAttack.length > 0) {\n        tensInfo += ` 主攻${data.tensMainAttack.join('')}`\n      }\n      if (data.tensKeyPoint && data.tensKeyPoint.length > 0) {\n        tensInfo += ` 重点${data.tensKeyPoint.join('')}`\n      }\n      result.push(tensInfo)\n    }\n    \n    // 个位\n    if (data.units && data.units.length > 0) {\n      let unitsInfo = `个位: ${data.units.join('')}`\n      if (data.unitsMainAttack && data.unitsMainAttack.length > 0) {\n        unitsInfo += ` 主攻${data.unitsMainAttack.join('')}`\n      }\n      if (data.unitsKeyPoint && data.unitsKeyPoint.length > 0) {\n        unitsInfo += ` 重点${data.unitsKeyPoint.join('')}`\n      }\n      result.push(unitsInfo)\n    }\n    \n    return result.length > 0 ? result.join(' | ') : '未选择'\n  }\n}\n\n// 获取分行显示的方案数据\nconst getSchemeDisplayData = (scheme) => {\n  const data = scheme.data\n  const result = []\n  \n  if (scheme.id === '二字现' || scheme.id === '三字现') {\n    // 组合类方案\n    if (data.combinations && data.combinations.length > 0) {\n      result.push(data.combinations.join(','))\n    } else {\n      result.push('未选择')\n    }\n  } else {\n    // 数字类方案 - 每位信息单独一行\n    if (data.thousands && data.thousands.length > 0) {\n      let thousandsInfo = `千位: ${data.thousands.join('')}`\n      if (data.thousandsMainAttack && data.thousandsMainAttack.length > 0) {\n        thousandsInfo += ` 主攻${data.thousandsMainAttack.join('')}`\n      }\n      if (data.thousandsKeyPoint && data.thousandsKeyPoint.length > 0) {\n        thousandsInfo += ` 重点${data.thousandsKeyPoint.join('')}`\n      }\n      result.push(thousandsInfo)\n    }\n    \n    if (data.hundreds && data.hundreds.length > 0) {\n      let hundredsInfo = `百位: ${data.hundreds.join('')}`\n      if (data.hundredsMainAttack && data.hundredsMainAttack.length > 0) {\n        hundredsInfo += ` 主攻${data.hundredsMainAttack.join('')}`\n      }\n      if (data.hundredsKeyPoint && data.hundredsKeyPoint.length > 0) {\n        hundredsInfo += ` 重点${data.hundredsKeyPoint.join('')}`\n      }\n      result.push(hundredsInfo)\n    }\n    \n    if (data.tens && data.tens.length > 0) {\n      let tensInfo = `十位: ${data.tens.join('')}`\n      if (data.tensMainAttack && data.tensMainAttack.length > 0) {\n        tensInfo += ` 主攻${data.tensMainAttack.join('')}`\n      }\n      if (data.tensKeyPoint && data.tensKeyPoint.length > 0) {\n        tensInfo += ` 重点${data.tensKeyPoint.join('')}`\n      }\n      result.push(tensInfo)\n    }\n    \n    if (data.units && data.units.length > 0) {\n      let unitsInfo = `个位: ${data.units.join('')}`\n      if (data.unitsMainAttack && data.unitsMainAttack.length > 0) {\n        unitsInfo += ` 主攻${data.unitsMainAttack.join('')}`\n      }\n      if (data.unitsKeyPoint && data.unitsKeyPoint.length > 0) {\n        unitsInfo += ` 重点${data.unitsKeyPoint.join('')}`\n      }\n      result.push(unitsInfo)\n    }\n    \n    if (result.length === 0) {\n      result.push('未选择')\n    }\n  }\n  \n  return result\n}\n\n// 修改方案\nconst modifyScheme = () => {\n  // 将当前方案数据传递回上级页面进行修改\n  uni.navigateBack({\n    delta: 1,\n    // 通过事件总线或全局状态传递数据\n    success: () => {\n      // 通知上级页面有数据需要修改\n      uni.$emit('modifySchemes', schemes.value)\n    }\n  })\n}\n\n// 发布方案\nconst publishScheme = async () => {\n  uni.showModal({\n    title: '确认发布',\n    content: '确定要发布这些方案吗？发布后将无法修改或删除。',\n    success: async (res) => {\n      if (res.confirm) {\n        await handlePublish()\n      }\n    }\n  })\n}\n\n// 测试追帖功能\nconst testAppendFunction = () => {\n  console.log('=== 测试追帖功能 ===')\n  console.log('当前帖子ID:', postId.value)\n  console.log('追帖模式:', isAppendMode.value)\n  \n  if (!postId.value) {\n    uni.showModal({\n      title: '测试结果',\n      content: '帖子ID缺失，无法测试追帖功能',\n      showCancel: false\n    })\n    return\n  }\n  \n  uni.showModal({\n    title: '测试追帖功能',\n    content: `帖子ID: ${postId.value}\\n方案数量: ${schemes.value.length}\\n\\n是否执行追帖？`,\n    confirmText: '执行追帖',\n    cancelText: '取消',\n    success: (res) => {\n      if (res.confirm) {\n        handleAppendPost()\n      }\n    }\n  })\n}\n\n// 处理追帖逻辑\nconst handleAppendPost = async () => {\n  if (!postId.value) {\n    uni.showToast({\n      title: '帖子ID缺失',\n      icon: 'none'\n    })\n    return\n  }\n  \n  try {\n    isAppending.value = true\n    uni.showLoading({\n      title: '追加中...'\n    })\n    \n    // 自动生成追加内容（包含原帖子内容）\n    const appendText = await generateAppendContent()\n    \n    // 调用追帖接口 - 只传递必要的参数，不包含pimg\n    const response = await apiPostUpdate({\n      id: postId.value,\n      content: appendText\n    })\n    \n    uni.hideLoading()\n    \n    if (response.code === 200) {\n      uni.showToast({\n        title: '追加成功',\n        icon: 'success'\n      })\n      \n      // 清理追帖相关数据\n      uni.removeStorageSync('appendPostData')\n      uni.removeStorageSync('currentAppendPostData')\n      uni.removeStorageSync('appendModeTipShown')\n      \n      // 延迟返回论坛页面\n      setTimeout(() => {\n        uni.reLaunch({\n          url: '/pages/forum/forum'\n        })\n      }, 1500)\n    } else {\n      uni.showToast({\n        title: response.msg || '追加失败',\n        icon: 'none'\n      })\n    }\n    \n  } catch (error) {\n    uni.hideLoading()\n    uni.showToast({\n      title: '追加失败，请重试',\n      icon: 'none'\n    })\n  } finally {\n    isAppending.value = false\n  }\n}\n\n// 生成追加内容\nconst generateAppendContent = async () => {\n  try {\n    // 首先获取原帖子的内容\n    let originalContent = ''\n    \n    if (postId.value) {\n      try {\n        // 尝试通过帖子列表查询获取原帖子内容\n        const response = await apiPostListQuery({\n          page: 1,\n          size: 50,\n          tname: currentLotteryType.value?.name || '预测方案'\n        })\n        \n        if (response.code === 200 && response.data && response.data.records && Array.isArray(response.data.records)) {\n          // 在查询结果中查找目标帖子\n          const targetPost = response.data.records.find(post => post.id == postId.value)\n          \n          if (targetPost) {\n            originalContent = targetPost.content || ''\n          }\n        }\n      } catch (error) {\n        // 如果API查询失败，尝试从本地存储获取\n        const appendData = uni.getStorageSync('currentAppendPostData')\n        if (appendData && appendData.postContent) {\n          originalContent = appendData.postContent\n        }\n      }\n    }\n    \n    // 生成追加内容\n    let appendContent = '\\n\\n--- 追加内容 ---\\n'\n    appendContent += `追加时间: ${new Date().toLocaleString()}\\n`\n    \n    if (schemes.value.length > 0) {\n      appendContent += '\\n追加方案:\\n'\n      schemes.value.forEach((scheme, index) => {\n        appendContent += `${index + 1}. [${scheme.id}]\\n`\n        \n        const displayData = getSchemeDisplayData(scheme)\n        displayData.forEach(info => {\n          appendContent += `   ${info}\\n`\n        })\n      })\n    } else {\n      appendContent += '\\n追加内容: 方案数据\\n'\n    }\n    \n    // 将追加内容添加到原内容后面\n    const finalContent = originalContent + appendContent\n    \n    return finalContent\n    \n  } catch (error) {\n    // 如果获取原内容失败，至少返回追加内容\n    let appendContent = '\\n\\n--- 追加内容 ---\\n'\n    appendContent += `追加时间: ${new Date().toLocaleString()}\\n`\n    \n    if (schemes.value.length > 0) {\n      appendContent += '\\n追加方案:\\n'\n      schemes.value.forEach((scheme, index) => {\n        appendContent += `${index + 1}. [${scheme.id}]\\n`\n        \n        const displayData = getSchemeDisplayData(scheme)\n        displayData.forEach(info => {\n          appendContent += `   ${info}\\n`\n        })\n      })\n    }\n    \n    return appendContent\n  }\n}\n\n// 处理发布逻辑\nconst handlePublish = async () => {\n  try {\n    uni.showLoading({\n      title: '发布中...'\n    })\n    \n    // 准备发帖数据\n    const postData = {\n      tname: lotteryType.value ? lotteryType.value.name : '预测方案', // 彩票名称\n      issueno: getIssueNumber(), // 期号 - 使用统一的期号获取函数\n      content: generatePostContent(), // 发帖内容\n      account: getAccount() || '', // 账号\n      pimg: '', // 预测帖不需要图片\n      flag: true // 无需审核\n    }\n    \n    console.log('发帖数据:', postData)\n    \n    const response = await apiPost(postData)\n    \n    uni.hideLoading()\n    \n    if (response.code === 200) {\n      // 保存帖子ID到本地存储，用于后续追帖\n      if (response.data && response.data.id) {\n        postId.value = response.data.id\n        uni.setStorageSync('currentPostId', response.data.id)\n        \n        // 保存今天已发布的方案和帖子ID映射\n        savePublishedSchemeData(response.data.id)\n      }\n      \n        uni.showToast({\n          title: '发布成功',\n          icon: 'success'\n        })\n      \n      // 清除本地存储的方案数据\n      uni.removeStorageSync('predict_schemes_data')\n      \n      // 延迟返回论坛页面\n        setTimeout(() => {\n        uni.reLaunch({\n          url: '/pages/forum/forum'\n        })\n        }, 1500)\n    } else {\n      uni.showToast({\n        title: response.msg || '发布失败',\n        icon: 'none'\n      })\n    }\n    \n  } catch (error) {\n    uni.hideLoading()\n    uni.showToast({\n      title: '发布失败，请重试',\n      icon: 'none'\n    })\n  }\n}\n\n// 获取期号显示\nconst getIssueNumber = () => {\n  return issueInfo.value.number || issueInfo.value.id || '--'\n}\n\n\n// 加载期号信息\nconst loadIssueInfo = async () => {\n  // 防止重复请求\n  if (isLoadingIssueInfo.value) {\n    console.log('正在加载期号信息，跳过重复请求')\n    return\n  }\n  \n  try {\n    isLoadingIssueInfo.value = true\n    if (!lotteryType.value || !lotteryType.value.id) {\n      return\n    }\n    \n    uni.showLoading({ title: '加载期号中...' })\n    \n    const response = await apiGetIssueNo({ tname: lotteryType.value.name })\n    \n    uni.hideLoading()\n    \n    if (response.code === 200 && response.data !== null && response.data !== undefined) {\n      let issueNumber = null\n      let issueStatus = '待开奖'\n      let issueTime = '今天 21:30'\n      \n      if (typeof response.data === 'number' || typeof response.data === 'string') {\n        issueNumber = response.data.toString()\n      } else if (typeof response.data === 'object') {\n        issueNumber = response.data.issueno || response.data.number || response.data.id\n        issueStatus = response.data.status || '待开奖'\n        issueTime = response.data.time || '今天 21:30'\n      }\n      \n      issueInfo.value = {\n        id: issueNumber,\n        number: issueNumber,\n        status: issueStatus,\n        time: issueTime\n      }\n      \n      uni.showToast({ title: `期号加载成功: ${issueNumber}`, icon: 'success' })\n    } else {\n      uni.showToast({ title: '期号数据为空', icon: 'none' })\n    }\n  } catch (error) {\n    uni.hideLoading()\n    console.error('加载期号信息失败:', error)\n    uni.showToast({ title: '期号加载异常', icon: 'none' })\n  } finally {\n    isLoadingIssueInfo.value = false\n  }\n}\n\n// 加载追帖模式下的方案数据\nconst loadSchemeForAppend = async (schemeId) => {\n  try {\n    console.log('=== 加载追帖方案数据 ===')\n    console.log('方案ID:', schemeId)\n    \n    const today = new Date().toDateString()\n    const publishedPosts = uni.getStorageSync(`publishedPosts_${today}`) || {}\n    \n    console.log('已发布的帖子映射:', publishedPosts)\n    \n    // 获取该方案对应的帖子ID\n    const schemePostId = publishedPosts[schemeId]\n    if (schemePostId) {\n      postId.value = schemePostId\n      console.log(`加载方案 ${schemeId} 对应的帖子ID:`, schemePostId)\n      \n      // 从接口获取帖子详细信息\n      await loadPostDetails(schemePostId)\n    } else {\n      console.log(`未找到方案 ${schemeId} 对应的帖子ID`)\n      \n      // 尝试从接口获取用户已发布的帖子\n      await loadUserPublishedPosts(schemeId)\n    }\n    \n  } catch (error) {\n    console.error('加载追帖方案数据失败:', error)\n  }\n}\n\n// 从接口获取帖子详细信息\nconst loadPostDetails = async (postId) => {\n  // 防止重复请求\n  if (isLoadingPostDetails.value) {\n    console.log('正在加载帖子详情，跳过重复请求')\n    return\n  }\n  \n  try {\n    isLoadingPostDetails.value = true\n    console.log('=== 获取帖子详细信息 ===')\n    console.log('帖子ID:', postId)\n    \n    // 调用帖子列表查询接口获取帖子详情\n    const response = await apiPostListQuery({\n      page: 1,\n      size: 1,\n      id: postId\n    })\n    \n    if (response.code === 200 && response.data && response.data.records && response.data.records.length > 0) {\n      const post = response.data.records[0]\n      console.log('帖子详情:', post)\n      \n      // 从帖子内容中解析方案数据\n      if (post.content) {\n        parseSchemeFromPostContent(post.content)\n      }\n    }\n    \n  } catch (error) {\n    console.error('获取帖子详情失败:', error)\n  } finally {\n    isLoadingPostDetails.value = false\n  }\n}\n\n// 从接口获取用户已发布的帖子\nconst loadUserPublishedPosts = async (schemeId) => {\n  // 防止重复请求\n  if (isLoadingUserPosts.value) {\n    console.log('正在加载用户帖子，跳过重复请求')\n    return\n  }\n  \n  try {\n    isLoadingUserPosts.value = true\n    console.log('=== 获取用户已发布帖子 ===')\n    console.log('方案ID:', schemeId)\n    \n    const response = await apiPostListQuery({\n      page: 1,\n      size: 20,\n      account: uni.getStorageSync('account') || ''\n    })\n    \n    if (response.code === 200 && response.data && response.data.records) {\n      // 查找包含指定方案的帖子\n      const targetPost = response.data.records.find(post => \n        post.content && post.content.includes(schemeId)\n      )\n      \n      if (targetPost) {\n        postId.value = targetPost.id\n        console.log(`找到方案 ${schemeId} 对应的帖子:`, targetPost.id)\n        \n        // 解析方案数据\n        parseSchemeFromPostContent(targetPost.content)\n      } else {\n        console.log(`未找到包含方案 ${schemeId} 的帖子`)\n      }\n    }\n    \n  } catch (error) {\n    console.error('获取用户已发布帖子失败:', error)\n  } finally {\n    isLoadingUserPosts.value = false\n  }\n}\n\n// 从帖子内容中解析方案数据\nconst parseSchemeFromPostContent = (content) => {\n  try {\n    console.log('=== 解析帖子内容 ===')\n    console.log('帖子内容:', content)\n    \n    // 这里可以根据帖子内容的格式来解析方案数据\n    // 暂时使用本地存储的方案数据作为备用\n    const savedSchemesData = uni.getStorageSync('predict_schemes_data')\n    console.log('本地存储的方案数据:', savedSchemesData)\n    \n    if (savedSchemesData && savedSchemesData.schemeData) {\n      // 尝试从本地存储中找到对应的方案数据\n      const schemeKeys = Object.keys(savedSchemesData.schemeData)\n      const matchingScheme = schemeKeys.find(key => content.includes(key))\n      \n      if (matchingScheme) {\n        const schemeData = savedSchemesData.schemeData[matchingScheme]\n        const schemeObj = {\n          id: matchingScheme,\n          name: matchingScheme,\n          data: schemeData\n        }\n        schemes.value = [schemeObj]\n        console.log('解析出的方案数据:', schemeObj)\n      }\n    }\n    \n  } catch (error) {\n    console.error('解析帖子内容失败:', error)\n  }\n}\n\n// 保存已发布的方案数据\nconst savePublishedSchemeData = (postId) => {\n  try {\n    const today = new Date().toDateString()\n    \n    // 获取今天已发布的方案列表\n    const publishedSchemes = uni.getStorageSync(`publishedSchemes_${today}`) || []\n    \n    // 获取今天已发布的帖子ID映射\n    const publishedPosts = uni.getStorageSync(`publishedPosts_${today}`) || {}\n    \n    // 遍历当前方案，记录已发布的方案\n    schemes.value.forEach(scheme => {\n      const schemeId = scheme.id\n      \n      // 如果方案还没有被标记为已发布，则添加\n      if (!publishedSchemes.includes(schemeId)) {\n        publishedSchemes.push(schemeId)\n      }\n      \n      // 保存方案对应的帖子ID\n      publishedPosts[schemeId] = postId\n    })\n    \n    // 保存到本地存储\n    uni.setStorageSync(`publishedSchemes_${today}`, publishedSchemes)\n    uni.setStorageSync(`publishedPosts_${today}`, publishedPosts)\n    \n    console.log('已保存发布数据:', {\n      publishedSchemes,\n      publishedPosts,\n      postId\n    })\n    \n  } catch (error) {\n    console.error('保存已发布方案数据失败:', error)\n  }\n}\n\n// 生成发帖内容\nconst generatePostContent = () => {\n  if (schemes.value.length === 0) {\n    return '暂无方案数据'\n  }\n  \n  let content = '【预测方案】\\n\\n'\n  \n  schemes.value.forEach((scheme, index) => {\n    content += `${index + 1}. ${scheme.name} (${scheme.id})\\n`\n    \n    const displayData = getSchemeDisplayData(scheme)\n    displayData.forEach(info => {\n      content += `   ${info}\\n`\n    })\n    content += '\\n'\n  })\n  \n      content += `期号: 第${getIssueNumber()}期\\n`\n  content += `发布时间: ${new Date().toLocaleString()}`\n  \n  return content\n}\n\n// 返回\nconst goBack = () => {\n  uni.showModal({\n    title: '提示',\n    content: '返回会清空内容,确定返回吗?',\n    confirmText: '确定',\n    cancelText: '取消',\n    confirmColor: '#ff4757',\n    success: (res) => {\n      if (res.confirm) {\n        // 清除本地存储的方案数据\n        try {\n          uni.removeStorageSync('predict_schemes_data')\n        } catch (error) {\n          console.error('清除本地存储失败:', error)\n        }\n        \n        // 点击确定，返回论坛页面\n        uni.reLaunch({\n          url: '/pages/forum/forum'\n        })\n      }\n      // 点击取消不做任何操作\n    }\n  })\n}\n\n// 页面加载时获取传递的方案数据\nonMounted(() => {\n  // 获取页面参数\n  const pages = getCurrentPages()\n  const currentPage = pages[pages.length - 1]\n  const options = currentPage.options\n  \n  console.log('=== 页面加载调试信息 ===')\n  console.log('页面参数:', options)\n  \n  // 检查是否有帖子ID（用于追帖功能）\n  if (options.postId) {\n    postId.value = options.postId\n    uni.setStorageSync('currentPostId', options.postId)\n    console.log('接收到帖子ID，进入追帖模式:', options.postId)\n    \n    // 进入追帖模式，隐藏发帖相关功能\n    isAppendMode.value = true\n    console.log('追帖模式已设置:', isAppendMode.value)\n    \n    // 如果有schemeId，加载对应的方案数据\n    if (options.schemeId) {\n      console.log('加载方案数据:', options.schemeId)\n      loadSchemeForAppend(options.schemeId)\n    }\n  } else {\n    // 从本地存储获取帖子ID - 只有在明确进入追帖模式时才设置\n    const savedPostId = uni.getStorageSync('currentPostId')\n    if (savedPostId) {\n      // 检查是否真的是追帖模式（通过检查是否有追帖数据）\n      const appendData = uni.getStorageSync('appendPostData')\n      if (appendData && appendData.postId === savedPostId) {\n        postId.value = savedPostId\n        isAppendMode.value = true\n        console.log('从本地存储恢复追帖模式:', savedPostId)\n      } else {\n        // 清除可能残留的帖子ID，确保是新帖模式\n        uni.removeStorageSync('currentPostId')\n        console.log('清除残留的帖子ID，确保新帖模式')\n      }\n    }\n  }\n  \n  console.log('最终状态 - 帖子ID:', postId.value, '追帖模式:', isAppendMode.value)\n  \n  if (options.data) {\n    try {\n      const publishData = JSON.parse(decodeURIComponent(options.data))\n      \n      schemes.value = publishData.schemes || []\n      lotteryType.value = publishData.lotteryType || null\n      issueInfo.value = publishData.issueInfo || {\n        id: null,\n        number: null,\n        status: '待开奖',\n        time: '今天 21:30'\n      }\n      \n      // 如果期号信息为空或无效，主动获取期号\n      if (!issueInfo.value.number && !issueInfo.value.id) {\n        loadIssueInfo()\n      }\n    } catch (error) {\n      uni.showToast({\n        title: '数据解析失败',\n        icon: 'none'\n      })\n    }\n  } else if (options.schemes) {\n    // 兼容旧的URL参数格式\n    try {\n      const decodedSchemes = decodeURIComponent(options.schemes)\n      schemes.value = JSON.parse(decodedSchemes)\n    } catch (error) {\n      uni.showToast({\n        title: '数据解析失败',\n        icon: 'none'\n      })\n    }\n  } else {\n    // 如果没有接收到数据，显示空状态\n    schemes.value = []\n    uni.showToast({\n      title: '没有方案数据',\n      icon: 'none'\n    })\n  }\n})\n</script>\n\n<style scoped>\n.publish-container {\n  min-height: 100vh;\n  background-color: #f5f5f5;\n}\n\n/* 导航栏 */\n.navbar {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  height: 88rpx;\n  background-color: #28B389;\n  z-index: 999;\n}\n\n.nav-content {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  height: 100%;\n  padding: 0 30rpx;\n}\n\n.nav-left, .nav-right {\n  width: 60rpx;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.back-arrow {\n  font-size: 40rpx;\n  color: #fff;\n  font-weight: bold;\n}\n\n.nav-title {\n  font-size: 36rpx;\n  font-weight: 600;\n  color: #fff;\n}\n\n/* 主要内容区域 */\n.main-content {\n  padding-top: 88rpx;\n  padding-bottom: 200rpx; /* 为底部按钮留出空间 */\n  padding-left: 30rpx;\n  padding-right: 30rpx;\n}\n\n/* 标题区域 */\n.title-section {\n  margin-bottom: 30rpx;\n}\n\n.title-text {\n  font-size: 32rpx;\n  font-weight: 600;\n  color: #333;\n}\n\n/* 方案列表 */\n.scheme-list {\n  margin-bottom: 40rpx;\n}\n\n.scheme-item {\n  background-color: #fff;\n  border-radius: 15rpx;\n  margin-bottom: 20rpx;\n  padding: 30rpx;\n  box-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.1);\n}\n\n.scheme-content {\n  display: flex;\n  flex-direction: column;\n  gap: 15rpx;\n}\n\n.scheme-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding-bottom: 10rpx;\n  border-bottom: 1rpx solid #f0f0f0;\n}\n\n.scheme-name {\n  font-size: 32rpx;\n  font-weight: 600;\n  color: #ff4757;\n}\n\n.scheme-type {\n  background-color: #28B389;\n  color: #fff;\n  padding: 8rpx 16rpx;\n  border-radius: 20rpx;\n  font-size: 22rpx;\n  font-weight: 500;\n}\n\n.scheme-details {\n  padding: 10rpx 0;\n}\n\n.scheme-data {\n  background-color: #f8f9fa;\n  padding: 15rpx;\n  border-radius: 10rpx;\n  border-left: 4rpx solid #28B389;\n  display: flex;\n  flex-direction: column;\n  gap: 8rpx;\n}\n\n.position-info {\n  font-size: 28rpx;\n  color: #333;\n  line-height: 1.4;\n  word-wrap: break-word;\n  word-break: break-all;\n}\n\n/* 空状态样式 */\n.empty-state {\n  text-align: center;\n  padding: 60rpx 30rpx;\n}\n\n.empty-text {\n  font-size: 28rpx;\n  color: #999;\n}\n\n\n/* 期号信息 */\n.period-info {\n  text-align: center;\n  margin-bottom: 30rpx;\n}\n\n.period-text {\n  font-size: 24rpx;\n  color: #999;\n  margin-bottom: 8rpx;\n}\n\n.period-status {\n  font-size: 22rpx;\n  color: #ff4757;\n}\n\n/* 底部区域 */\n.bottom-section {\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background-color: #fff;\n  padding: 20rpx 30rpx;\n  box-shadow: 0 -2rpx 10rpx rgba(0, 0, 0, 0.1);\n}\n\n/* 警告信息 */\n.warning-section {\n  margin-bottom: 20rpx;\n  text-align: center;\n}\n\n.warning-text {\n  font-size: 24rpx;\n  color: #ff4757;\n}\n\n/* 操作按钮 */\n.action-buttons {\n  display: flex;\n  gap: 20rpx;\n}\n\n.modify-btn, .publish-btn {\n  flex: 1;\n  height: 80rpx;\n  border-radius: 40rpx;\n  font-size: 28rpx;\n  font-weight: 500;\n  border: none;\n}\n\n.modify-btn {\n  background-color: #f0f0f0;\n  color: #666;\n}\n\n.publish-btn {\n  background-color: #ff4757;\n  color: #fff;\n}\n\n/* 追帖功能样式 */\n.append-section {\n  margin-top: 40rpx;\n  background-color: #fff;\n  border-radius: 15rpx;\n  padding: 30rpx;\n  box-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.1);\n}\n\n.append-title {\n  margin-bottom: 20rpx;\n  display: flex;\n  flex-direction: column;\n  gap: 10rpx;\n}\n\n.append-title-text {\n  font-size: 30rpx;\n  font-weight: 600;\n  color: #333;\n}\n\n.append-post-id {\n  font-size: 24rpx;\n  color: #666;\n  background-color: #f0f0f0;\n  padding: 8rpx 16rpx;\n  border-radius: 20rpx;\n  align-self: flex-start;\n}\n\n.append-info {\n  margin: 20rpx 0;\n  padding: 20rpx;\n  background-color: #f8f9fa;\n  border-radius: 10rpx;\n  text-align: center;\n}\n\n.append-info-text {\n  font-size: 26rpx;\n  color: #666;\n}\n\n.append-buttons {\n  display: flex;\n  justify-content: center;\n  gap: 20rpx;\n  margin-top: 30rpx;\n}\n\n.append-btn {\n  width: 200rpx;\n  height: 70rpx;\n  background-color: #28B389;\n  color: #fff;\n  border: none;\n  border-radius: 35rpx;\n  font-size: 26rpx;\n  font-weight: 500;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.append-btn.disabled {\n  background-color: #ccc;\n  color: #999;\n}\n\n</style>\n\n","import MiniProgramPage from 'C:/梓梅2.0/梓梅xcx/my-painting-rules-project/pages/predict-publish/predict-publish.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uni","apiPostUpdate","apiPostListQuery","getAccount","apiPost","apiGetIssueNo","postId","onMounted"],"mappings":"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"}