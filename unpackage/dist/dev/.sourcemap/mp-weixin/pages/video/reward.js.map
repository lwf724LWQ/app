{"version":3,"file":"reward.js","sources":["pages/video/reward.vue","D:/uniapp/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdmlkZW8vcmV3YXJkLnZ1ZQ"],"sourcesContent":["<template>\r\n  <view class=\"reward-container\">\r\n    <!-- 导航栏 -->\r\n    <view class=\"navbar\">\r\n      <view class=\"nav-content\">\r\n        <view class=\"nav-left\" @click=\"goBack\">\r\n          <text class=\"back-arrow\">‹</text>\r\n        </view>\r\n        <view class=\"nav-center\">\r\n          <text class=\"nav-title\">打赏作者</text>\r\n        </view>\r\n      </view>\r\n    </view>\r\n    \r\n    <!-- 作者信息 -->\r\n    <view class=\"author-info\">\r\n      <view class=\"author-avatar\">\r\n        <!-- 使用从路由参数获取的头像 -->\r\n        <image :src=\"getAvatarUrl(authorAvatar)\" class=\"avatar\"></image>\r\n        <view class=\"v-badge\">V</view>\r\n      </view>\r\n      <view class=\"author-details\">\r\n        <!-- 使用从路由参数获取的作者名称 -->\r\n        <text class=\"author-name\">{{ authorName }}</text>\r\n        <text class=\"author-location\">{{ authorLocation }}</text>\r\n      </view>\r\n    </view>\r\n    \r\n    <!-- 打赏金额选项 -->\r\n    <view class=\"reward-options\">\r\n      <text class=\"section-title\">选择打赏金额</text>\r\n      <view class=\"amount-grid\">\r\n        <view \r\n          v-for=\"(amount, index) in amountOptions\" \r\n          :key=\"index\" \r\n          class=\"amount-option\"\r\n          :class=\"{ 'active': selectedAmount === amount }\"\r\n          @click=\"selectAmount(amount)\"\r\n        >\r\n          <text class=\"amount-text\">¥{{ amount }}</text>\r\n        </view>\r\n      </view>\r\n      \r\n      <!-- 添加自定义金额区域 -->\r\n      <view class=\"custom-amount-section\">\r\n        <text class=\"custom-title\">自定义金额</text>\r\n        <view class=\"custom-input-container\">\r\n          <text class=\"currency-symbol\">¥</text>\r\n          <input \r\n            type=\"number\" \r\n            class=\"custom-input\" \r\n            placeholder=\"输入金额\" \r\n            v-model=\"customAmount\"\r\n            @input=\"validateCustomAmount\"\r\n          />\r\n          <button class=\"confirm-custom-btn\" @click=\"confirmCustomAmount\">确定</button>\r\n        </view>\r\n      </view>\r\n    </view>\r\n    \r\n    <!-- 支付方式选择 -->\r\n    <view class=\"payment-methods\">\r\n      <text class=\"section-title\">支付方式</text>\r\n      <radio-group @change=\"selectPaymentMethod\">\r\n        <label class=\"payment-method\">\r\n          <radio value=\"0\" :checked=\"paymentMethod === '0'\" /> \r\n          <text class=\"method-text\">微信支付</text>\r\n        </label>\r\n        <label class=\"payment-method\">\r\n          <radio value=\"1\" :checked=\"paymentMethod === '1'\" /> \r\n          <text class=\"method-text\">账户余额</text>\r\n        </label>\r\n      </radio-group>\r\n    </view>\r\n    \r\n    <!-- 支付按钮 -->\r\n    <view class=\"payment-btn-container\">\r\n      <button class=\"payment-btn\" @click=\"handleReward\">支付 ¥{{ selectedAmount }}元</button>\r\n    </view>\r\n    \r\n    <!-- 二维码支付弹出层 -->\r\n    <view class=\"qr-modal\" v-if=\"showQRModal\" @click=\"closeQRModal\">\r\n      <view class=\"qr-content\" @click.stop>\r\n        <view class=\"qr-header\">\r\n          <text class=\"qr-title\">扫码支付</text>\r\n          <text class=\"close-btn\" @click=\"closeQRModal\">×</text>\r\n        </view>\r\n        <view class=\"qr-body\">\r\n          <view class=\"qr-code-container\">\r\n            <image \r\n              v-if=\"qrCodeUrl\"\r\n              :src=\"qrCodeUrl\" \r\n              class=\"qr-image\"\r\n              :style=\"{ width: qrSize + 'px', height: qrSize + 'px' }\"\r\n              mode=\"aspectFit\"\r\n            ></image>\r\n            <view v-else class=\"qr-loading\">\r\n              <text class=\"loading-text\">生成二维码中...</text>\r\n            </view>\r\n          </view>\r\n          <text class=\"qr-tip\">请使用微信扫描二维码完成支付</text>\r\n          <text class=\"qr-amount\">支付金额：¥{{ selectedAmount }}元</text>\r\n          <text class=\"qr-status\" v-if=\"isCheckingPayment\">正在检查支付状态...</text>\r\n          <text class=\"qr-hint\" v-if=\"isCheckingPayment\">如已支付完成，可点击下方\"支付完成\"按钮</text>\r\n        </view>\r\n       <!-- <view class=\"qr-footer\">\r\n          <button class=\"cancel-qr-btn\" @click=\"closeQRModal\">取消支付</button>\r\n          <button class=\"refresh-qr-btn\" @click=\"refreshQRCode\">刷新二维码</button>\r\n          <button class=\"success-qr-btn\" @click=\"handlePaymentSuccess\">支付完成</button>\r\n        </view> -->\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from 'vue';\r\nimport { onLoad } from '@dcloudio/uni-app';\r\nimport { apiRewardVideo, apiWxpay, apiCheckVideoPayment } from '@/api/apis';\r\nimport { getToken, getAccount } from '@/utils/request.js';\r\n\r\n// 打赏金额选项\r\nconst amountOptions = ref([1.8, 3.8, 5.8, 6.8, 8.8, 18, 38, 58, 68]);\r\n\r\n// 选中的金额\r\nconst selectedAmount = ref(3.8);\r\n\r\n// 自定义金额\r\nconst customAmount = ref('');\r\nconst isCustomAmountSelected = ref(false);\r\n\r\n// 支付方式 (0:微信 1:账户余额)\r\nconst paymentMethod = ref('0');\r\n\r\n// 作者信息\r\nconst authorName = ref('追梦人');\r\nconst authorAvatar = ref('');\r\nconst authorLocation = ref('海南省 - 儋州市');\r\n\r\n// 路由参数\r\nconst routeParams = ref({\r\n  videoId: '',\r\n  author: '',\r\n  title: '',\r\n  authorAvatar: '', // 添加作者头像参数\r\n  authorName: ''   // 添加作者名称参数\r\n});\r\n\r\n// 二维码相关数据\r\nconst showQRModal = ref(false);\r\nconst qrSize = ref(200);\r\nconst currentPaymentUrl = ref('');\r\nconst qrCodeUrl = ref('');\r\nconst paymentCheckTimer = ref(null);\r\nconst isCheckingPayment = ref(false);\r\n\r\n// 获取路由参数\r\nonLoad((options) => {\r\n  if (options.videoId) routeParams.value.videoId = options.videoId;\r\n  if (options.author) routeParams.value.author = decodeURIComponent(options.author);\r\n  if (options.title) routeParams.value.title = decodeURIComponent(options.title);\r\n  \r\n  // 获取作者头像和名称\r\n  if (options.authorAvatar) {\r\n    authorAvatar.value = decodeURIComponent(options.authorAvatar);\r\n  }\r\n  if (options.authorName) {\r\n    authorName.value = decodeURIComponent(options.authorName);\r\n  }\r\n});\r\n\r\n// 获取头像URL\r\nconst getAvatarUrl = (avatar) => {\r\n  if (!avatar) return '/static/default-avatar.png';\r\n  return `http://video.caimizm.com/himg/${avatar}`;\r\n};\r\n\r\n// 选择金额\r\nconst selectAmount = (amount) => {\r\n  selectedAmount.value = amount;\r\n  isCustomAmountSelected.value = false;\r\n};\r\n\r\n// 选择支付方式\r\nconst selectPaymentMethod = (e) => {\r\n  paymentMethod.value = e.detail.value;\r\n};\r\n\r\n// 返回上一页\r\nconst goBack = () => {\r\n  uni.navigateBack();\r\n};\r\n\r\n// 验证自定义金额\r\nconst validateCustomAmount = () => {\r\n  // 确保金额为正数\r\n  if (customAmount.value < 0) {\r\n    customAmount.value = '';\r\n  }\r\n};\r\n\r\n// 确认自定义金额\r\nconst confirmCustomAmount = () => {\r\n  if (!customAmount.value) {\r\n    uni.showToast({\r\n      title: '请输入金额',\r\n      icon: 'none'\r\n    });\r\n    return;\r\n  }\r\n  \r\n  const amount = parseFloat(customAmount.value);\r\n  if (isNaN(amount) || amount <= 0) {\r\n    uni.showToast({\r\n      title: '请输入有效金额',\r\n      icon: 'none'\r\n    });\r\n    return;\r\n  }\r\n  \r\n  selectedAmount.value = amount;\r\n  isCustomAmountSelected.value = true;\r\n  uni.showToast({\r\n    title: '已选择自定义金额',\r\n    icon: 'success'\r\n  });\r\n};\r\n\r\n// 处理打赏\r\nconst handleReward = async () => {\r\n  // 检查是否登录\r\n  const token = getToken();\r\n  if (!token) {\r\n    uni.showToast({\r\n      title: '请先登录',\r\n      icon: 'none'\r\n    });\r\n    setTimeout(() => {\r\n      uni.navigateTo({\r\n        url: '/pages/login/login'\r\n      });\r\n    }, 1500);\r\n    return;\r\n  }\r\n  \r\n  // 如果选择账户余额支付，直接调用打赏API\r\n  if (paymentMethod.value === '1') {\r\n    await processReward();\r\n    return;\r\n  }\r\n  \r\n  // 如果选择微信支付，显示确认支付弹窗\r\n  uni.showModal({\r\n    title: '确认支付',\r\n    content: `确认支付 ¥${selectedAmount.value}元 打赏作者？`,\r\n    success: (res) => {\r\n      if (res.confirm) {\r\n        processReward();\r\n      }\r\n    }\r\n  });\r\n};\r\n\r\n// 处理打赏流程\r\nconst processReward = async () => {\r\n  uni.showLoading({\r\n    title: '处理中...'\r\n  });\r\n  \r\n  try {\r\n    // 准备打赏数据\r\n    const rewardData = {\r\n      info: `打赏视频: ${routeParams.value.title}`,\r\n      amount: selectedAmount.value.toString(),\r\n      type: 2, // 2=打赏\r\n      account: getAccount(),\r\n      payType: paymentMethod.value,\r\n      channel: 1 // 微信小程序\r\n    };\r\n    \r\n    // 调用打赏API\r\n    const response = await apiRewardVideo(rewardData);\r\n    \r\n    if (response.code === 200 && response.data) {\r\n      // 如果选择微信支付，处理微信支付流程\r\n        // 调用微信支付API\r\n        const wxPayResponse = await callWxPayApi(response.data);\r\n        \r\n        if (wxPayResponse.code === 200) {\r\n          // 处理微信支付返回的数据\r\n          handleWxPayResponse(wxPayResponse.data);\r\n        } else {\r\n          uni.showToast({\r\n            title: wxPayResponse.msg || '微信支付请求失败',\r\n            icon: 'none'\r\n          });\r\n        }\r\n    } else {\r\n      uni.showToast({\r\n        title: response.msg || '打赏失败',\r\n        icon: 'none'\r\n      });\r\n    }\r\n    \r\n    uni.hideLoading();\r\n  } catch (error) {\r\n    uni.hideLoading();\r\n    console.error('打赏接口调用失败:', error);\r\n    uni.showToast({\r\n      title: '网络错误，请重试',\r\n      icon: 'none'\r\n    });\r\n  }\r\n};\r\n\r\n// 调用微信支付API\r\nconst callWxPayApi = async (orderNo) => {\r\n  try {\r\n    // 准备微信支付数据\r\n    const wxPayData = {\r\n      account: getAccount(),\r\n      orderNo: orderNo,\r\n      remark: routeParams.value.videoId\r\n    };\r\n    \r\n    // 调用微信支付API\r\n    return await apiWxpay(wxPayData);\r\n  } catch (error) {\r\n    console.error('微信支付接口调用失败:', error);\r\n    return {\r\n      code: 500,\r\n      msg: '微信支付接口调用失败'\r\n    };\r\n  }\r\n};\r\n\r\n// 处理微信支付返回的数据\r\nconst handleWxPayResponse = (wxPayData) => {\r\n  if (wxPayData && wxPayData.includes('weixin://wxpay')) {\r\n    // 显示二维码支付\r\n    currentPaymentUrl.value = wxPayData;\r\n    showQRModal.value = true;\r\n    \r\n    // 生成二维码\r\n    setTimeout(() => {\r\n      generateQRCode(wxPayData);\r\n      // 开始检查支付状态\r\n      startPaymentCheck();\r\n    }, 100);\r\n  }\r\n};\r\n\r\n// 二维码相关方法\r\nconst generateQRCode = (url) => {\r\n  try {\r\n    // 首先尝试使用qrcode库\r\n    import('qrcode').then(QRCode => {\r\n      // 生成二维码数据URL\r\n      QRCode.toDataURL(url, {\r\n        width: qrSize.value,\r\n        height: qrSize.value,\r\n        margin: 2,\r\n        color: {\r\n          dark: '#000000',\r\n          light: '#FFFFFF'\r\n        }\r\n      }, (error, dataUrl) => {\r\n        if (error) {\r\n          console.error('二维码生成失败:', error);\r\n          // 使用在线服务作为备选\r\n          generateQRCodeOnline(url);\r\n        } else {\r\n          // 直接设置二维码URL\r\n          qrCodeUrl.value = dataUrl;\r\n        }\r\n      });\r\n    }).catch(error => {\r\n      console.error('导入qrcode库失败:', error);\r\n      // 使用在线服务作为备选\r\n      generateQRCodeOnline(url);\r\n    });\r\n  } catch (error) {\r\n    console.error('生成二维码失败:', error);\r\n    // 使用在线服务作为备选\r\n    generateQRCodeOnline(url);\r\n  }\r\n};\r\n\r\n// 使用在线服务生成二维码\r\nconst generateQRCodeOnline = (url) => {\r\n  try {\r\n    // 使用qrcode.js在线服务\r\n    const encodedUrl = encodeURIComponent(url);\r\n    const qrApiUrl = `https://api.qrserver.com/v1/create-qr-code/?size=${qrSize.value}x${qrSize.value}&data=${encodedUrl}`;\r\n    qrCodeUrl.value = qrApiUrl;\r\n  } catch (error) {\r\n    console.error('在线二维码生成失败:', error);\r\n    uni.showToast({\r\n      title: '二维码生成失败',\r\n      icon: 'none'\r\n    });\r\n  }\r\n};\r\n\r\n// 开始检查支付状态\r\nconst startPaymentCheck = () => {\r\n  // 清除之前的定时器\r\n  if (paymentCheckTimer.value) {\r\n    clearInterval(paymentCheckTimer.value);\r\n  }\r\n  \r\n  isCheckingPayment.value = true;\r\n  let checkCount = 0;\r\n  const maxChecks = 20; // 最多检查20次（100秒）\r\n  \r\n  // 每3秒检查一次支付状态\r\n  paymentCheckTimer.value = setInterval(async () => {\r\n    try {\r\n      checkCount++;\r\n      \r\n      // 调用真实API检查支付状态\r\n      const paymentStatus = await checkRealPaymentStatus();\r\n      \r\n      if (paymentStatus === true) {\r\n        // 支付成功\r\n        await handlePaymentSuccess();\r\n        return;\r\n      } else if (paymentStatus === false) {\r\n        // 支付失败或仍在处理中，继续检查\r\n        console.log('支付状态检查中...');\r\n      }\r\n      \r\n      // 如果检查次数达到上限，停止检查\r\n      if (checkCount >= maxChecks) {\r\n        console.log('支付检查超时，停止检查');\r\n        stopPaymentCheck();\r\n        uni.showToast({\r\n          title: '支付检查超时，请手动确认',\r\n          icon: 'none',\r\n          duration: 3000\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.error('检查支付状态失败:', error);\r\n    }\r\n  }, 3000);\r\n};\r\n\r\n// 检查真实支付状态\r\nconst checkRealPaymentStatus = async () => {\r\n  try {\r\n    // 调用支付状态检查API\r\n    const response = await apiCheckVideoPayment({\r\n      videoId: routeParams.value.videoId,\r\n      account: getAccount()\r\n    });\r\n    \r\n    if (response.code === 200) {\r\n      // 根据API返回的data字段判断支付状态\r\n      return response.data; // true表示已支付，false表示未支付\r\n    }\r\n    \r\n    return false;\r\n  } catch (error) {\r\n    console.error('支付状态检查API调用失败:', error);\r\n    return false;\r\n  }\r\n};\r\n\r\n// 处理支付成功\r\nconst handlePaymentSuccess = async () => {\r\n  try {\r\n    // 停止检查支付状态\r\n    stopPaymentCheck();\r\n    \r\n    // 显示支付成功提示\r\n    uni.showModal({\r\n      title: '支付成功',\r\n      content: `恭喜您！成功打赏${selectedAmount.value}金币`,\r\n      showCancel: false,\r\n      success: () => {\r\n        // 关闭二维码弹窗\r\n        closeQRModal();\r\n        \r\n        // 延迟返回上一页\r\n        setTimeout(() => {\r\n          uni.navigateBack();\r\n        }, 500);\r\n      }\r\n    });\r\n  } catch (error) {\r\n    console.error('处理支付成功失败:', error);\r\n  }\r\n};\r\n\r\n// 关闭二维码弹窗\r\nconst closeQRModal = () => {\r\n  // 停止检查支付状态\r\n  stopPaymentCheck();\r\n  \r\n  showQRModal.value = false;\r\n  currentPaymentUrl.value = '';\r\n  qrCodeUrl.value = '';\r\n};\r\n\r\n// 刷新二维码\r\nconst refreshQRCode = () => {\r\n  if (currentPaymentUrl.value) {\r\n    qrCodeUrl.value = ''; // 清空当前二维码\r\n    generateQRCode(currentPaymentUrl.value);\r\n  }\r\n};\r\n\r\n// 停止检查支付状态\r\nconst stopPaymentCheck = () => {\r\n  if (paymentCheckTimer.value) {\r\n    clearInterval(paymentCheckTimer.value);\r\n    paymentCheckTimer.value = null;\r\n  }\r\n  isCheckingPayment.value = false;\r\n  console.log('停止检查支付状态');\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.reward-container {\r\n  padding: 20rpx;\r\n  background-color: #f5f5f5;\r\n  min-height: 100vh;\r\n}\r\n\r\n/* 导航栏 */\r\n.navbar {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  height: 88rpx;\r\n  background-color: #fff;\r\n  z-index: 999;\r\n  border-bottom: 1rpx solid #e8e8e8;\r\n}\r\n\r\n.nav-content {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  height: 100%;\r\n  padding: 0 30rpx;\r\n}\r\n\r\n.nav-left, .nav-right {\r\n  width: 80rpx;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.back-arrow {\r\n  font-size: 40rpx;\r\n  color: #333;\r\n  font-weight: bold;\r\n}\r\n\r\n.nav-center {\r\n  flex: 1;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n}\r\n\r\n.nav-title {\r\n  font-size: 36rpx;\r\n  font-weight: 600;\r\n  color: #333;\r\n  text-align: center;\r\n}\r\n\r\n/* 作者信息 */\r\n.author-info {\r\n  margin-top: 100rpx;\r\n  padding: 30rpx;\r\n  background-color: #fff;\r\n  border-radius: 16rpx;\r\n  box-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.05);\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.author-avatar {\r\n  position: relative;\r\n  margin-right: 20rpx;\r\n}\r\n\r\n.avatar {\r\n  width: 80rpx;\r\n  height: 80rpx;\r\n  border-radius: 50%;\r\n  background-color: #f0f0f0;\r\n}\r\n\r\n.v-badge {\r\n  position: absolute;\r\n  bottom: 0;\r\n  right: 0;\r\n  width: 24rpx;\r\n  height: 24rpx;\r\n  background-color: #ffd700;\r\n  border-radius: 50%;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-size: 16rpx;\r\n  font-weight: bold;\r\n  color: #fff;\r\n}\r\n\r\n.author-details {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.author-name {\r\n  font-size: 32rpx;\r\n  font-weight: bold;\r\n  color: #333;\r\n  margin-bottom: 8rpx;\r\n}\r\n\r\n.author-location {\r\n  font-size: 24rpx;\r\n  color: #666;\r\n}\r\n\r\n/* 打赏金额选项 */\r\n.reward-options {\r\n  margin-top: 30rpx;\r\n  padding: 20rpx;\r\n  background-color: #fff;\r\n  border-radius: 16rpx;\r\n  box-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.05);\r\n}\r\n\r\n.section-title {\r\n  font-size: 32rpx;\r\n  font-weight: bold;\r\n  color: #333;\r\n  margin-bottom: 20rpx;\r\n  display: block;\r\n}\r\n\r\n.amount-grid {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 20rpx;\r\n  margin-bottom: 30rpx;\r\n}\r\n\r\n.amount-option {\r\n  flex: 1;\r\n  min-width: 150rpx;\r\n  padding: 20rpx;\r\n  border: 2rpx solid #3498db;\r\n  border-radius: 16rpx;\r\n  text-align: center;\r\n  background-color: #f8f8f8;\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.amount-option.active {\r\n  background-color: #3498db;\r\n  color: #fff;\r\n  transform: translateY(-5rpx);\r\n  box-shadow: 0 4rpx 12rpx rgba(52, 152, 219, 0.2);\r\n}\r\n\r\n.amount-text {\r\n  font-size: 28rpx;\r\n  font-weight: bold;\r\n}\r\n\r\n/* 自定义金额区域 */\r\n.custom-amount-section {\r\n  margin-top: 20rpx;\r\n}\r\n\r\n.custom-title {\r\n  font-size: 28rpx;\r\n  font-weight: bold;\r\n  color: #333;\r\n  margin-bottom: 15rpx;\r\n  display: block;\r\n}\r\n\r\n.custom-input-container {\r\n  display: flex;\r\n  align-items: center;\r\n  border: 2rpx solid #3498db;\r\n  border-radius: 16rpx;\r\n  padding: 10rpx 15rpx;\r\n  background-color: #f8f8f8;\r\n}\r\n\r\n.currency-symbol {\r\n  font-size: 32rpx;\r\n  font-weight: bold;\r\n  color: #3498db;\r\n  margin-right: 10rpx;\r\n}\r\n\r\n.custom-input {\r\n  flex: 1;\r\n  font-size: 32rpx;\r\n  height: 60rpx;\r\n  padding: 0 15rpx;\r\n  background-color: transparent;\r\n}\r\n\r\n.confirm-custom-btn {\r\n  background-color: #3498db;\r\n  color: white;\r\n  border-radius: 40rpx;\r\n  padding: 10rpx 20rpx;\r\n  font-size: 28rpx;\r\n  font-weight: 500;\r\n}\r\n\r\n/* 支付方式选择 */\r\n.payment-methods {\r\n  margin-top: 30rpx;\r\n  padding: 20rpx;\r\n  background-color: #fff;\r\n  border-radius: 16rpx;\r\n  box-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.05);\r\n}\r\n\r\n.payment-method {\r\n  display: flex;\r\n  align-items: center;\r\n  margin-bottom: 15rpx;\r\n  font-size: 28rpx;\r\n  color: #333;\r\n}\r\n\r\n.method-text {\r\n  margin-left: 15rpx;\r\n}\r\n\r\n/* 支付按钮 */\r\n.payment-btn-container {\r\n  margin-top: 40rpx;\r\n  padding: 0 30rpx;\r\n}\r\n\r\n.payment-btn {\r\n  background-color: #3498db;\r\n  color: white;\r\n  border-radius: 50rpx;\r\n  padding: 25rpx;\r\n  font-size: 34rpx;\r\n  font-weight: 500;\r\n}\r\n\r\n/* 二维码弹出层样式 */\r\n.qr-modal {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background-color: rgba(0, 0, 0, 0.5);\r\n  z-index: 1000;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: 40rpx;\r\n}\r\n\r\n.qr-content {\r\n  width: 100%;\r\n  max-width: 500rpx;\r\n  background-color: #fff;\r\n  border-radius: 20rpx;\r\n  display: flex;\r\n  flex-direction: column;\r\n  box-shadow: 0 10rpx 40rpx rgba(0, 0, 0, 0.2);\r\n}\r\n\r\n.qr-header {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  padding: 30rpx;\r\n  border-bottom: 1rpx solid #f0f0f0;\r\n}\r\n\r\n.qr-title {\r\n  font-size: 36rpx;\r\n  font-weight: 600;\r\n  color: #333;\r\n}\r\n\r\n.close-btn {\r\n  font-size: 40rpx;\r\n  color: #999;\r\n  font-weight: bold;\r\n  width: 60rpx;\r\n  text-align: center;\r\n}\r\n\r\n.qr-body {\r\n  padding: 40rpx;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n}\r\n\r\n.qr-code-container {\r\n  margin-bottom: 30rpx;\r\n  padding: 20rpx;\r\n  background-color: #f8f9fa;\r\n  border-radius: 15rpx;\r\n}\r\n\r\n.qr-image {\r\n  display: block;\r\n  border-radius: 10rpx;\r\n}\r\n\r\n.qr-loading {\r\n  width: 200px;\r\n  height: 200px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  background-color: #f8f9fa;\r\n  border-radius: 10rpx;\r\n}\r\n\r\n.loading-text {\r\n  font-size: 28rpx;\r\n  color: #666;\r\n}\r\n\r\n.qr-tip {\r\n  font-size: 28rpx;\r\n  color: #666;\r\n  text-align: center;\r\n  margin-bottom: 15rpx;\r\n}\r\n\r\n.qr-amount {\r\n  font-size: 32rpx;\r\n  color: #ff4757;\r\n  font-weight: 600;\r\n  text-align: center;\r\n}\r\n\r\n.qr-status {\r\n  font-size: 24rpx;\r\n  color: #28B389;\r\n  text-align: center;\r\n  margin-top: 10rpx;\r\n  animation: pulse 1.5s infinite;\r\n}\r\n\r\n.qr-hint {\r\n  font-size: 22rpx;\r\n  color: #999;\r\n  text-align: center;\r\n  margin-top: 8rpx;\r\n  line-height: 1.4;\r\n}\r\n\r\n@keyframes pulse {\r\n  0% { opacity: 1; }\r\n  50% { opacity: 0.5; }\r\n  100% { opacity: 1; }\r\n}\r\n\r\n.qr-footer {\r\n  display: flex;\r\n  gap: 20rpx;\r\n  padding: 30rpx;\r\n  border-top: 1rpx solid #f0f0f0;\r\n}\r\n\r\n.cancel-qr-btn, .refresh-qr-btn, .success-qr-btn {\r\n  flex: 1;\r\n  height: 80rpx;\r\n  border: none;\r\n  border-radius: 40rpx;\r\n  font-size: 28rpx;\r\n  font-weight: 500;\r\n}\r\n\r\n.cancel-qr-btn {\r\n  background-color: #f5f5f5;\r\n  color: #666;\r\n}\r\n\r\n.refresh-qr-btn {\r\n  background-color: #28B389;\r\n  color: #fff;\r\n}\r\n\r\n.success-qr-btn {\r\n  background-color: #ff4757;\r\n  color: #fff;\r\n}\r\n</style>","import MiniProgramPage from 'C:/梓梅2.0/梓梅xcx/my-painting-rules-project/pages/video/reward.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","onLoad","uni","getToken","getAccount","apiRewardVideo","apiWxpay","apiCheckVideoPayment"],"mappings":"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"}