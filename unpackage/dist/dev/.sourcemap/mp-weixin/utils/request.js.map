{"version":3,"file":"request.js","sources":["utils/request.js"],"sourcesContent":["\r\nconst BASE_URL = 'http://caimi.s7.tunnelfrp.com';\r\n\r\n// 全局token变量\r\nlet globalToken = '';\r\n// 设置token的方法\r\nexport function setToken(token) {\r\n  globalToken = token;\r\n  uni.setStorageSync('token', token);//保存到本地\r\n}\r\n// 获取Token的方法\r\nexport function getToken() {\r\n    const localToken = uni.getStorageSync('token');\r\n    return globalToken || localToken;\r\n}\r\n// 移除Token的方法\r\nexport function removeToken() {\r\n    globalToken = '';\r\n    uni.removeStorageSync('token');\r\n}\r\n\r\nexport function apiGetBanner(){\r\n\treturn request({\r\n\t\turl:\"/homeBanner\"\r\n\t})\t\r\n}\r\n\r\n//设置账号\r\nlet globalAccount = '';\r\n// 设置账号的方法\r\nexport function setAccount(account) {\r\n  globalAccount = account;\r\n  uni.setStorageSync('account', account);//保存到本地\r\n}\r\n// 获取账号的方法\r\nexport function getAccount() {\r\n    const localAccount = uni.getStorageSync('account');\r\n    return globalAccount || localAccount;\r\n}\r\n\r\nexport function request(config={}){\t\r\n\tlet {\r\n\t\turl,\r\n\t\tdata={},\r\n\t\tmethod=\"GET\",\r\n\t\theader={}\r\n\t} = config\r\n\t\r\n\turl = BASE_URL+url\r\n\t// header['access-key'] = \"xxxxxx\"\r\n\t//如果有令牌\r\n\tconst token = getToken();\r\n\tif (token) {\r\n\t    header.Authorization = `${token}`;\r\n\t}\r\n\treturn new Promise((resolve,reject)=>{\t\t\r\n\t\tuni.request({\r\n\t\t\turl,\r\n\t\t\tdata,\r\n\t\t\tmethod,\r\n\t\t\theader,\r\n\t\t\tsuccess:res=>{\r\n\t\t\t\tif (res.statusCode === 200) {\r\n\t\t\t\t\tif(res.data && res.data.code === 200){\r\n\t\t\t\t\t\tresolve(res.data)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treject(res.data)\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\treject({\r\n\t\t\t\t\t\tcode: res.statusCode,\r\n\t\t\t\t\t\tmsg: `HTTP错误: ${res.statusCode}`,\r\n\t\t\t\t\t\tdata: res.data\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tfail:err=>{\r\n\t\t\t\treject(err)\r\n\t\t\t}\r\n\t\t})\r\n\t})\r\n}\r\n"],"names":["uni"],"mappings":";;AACA,MAAM,WAAW;AAGjB,IAAI,cAAc;AAEX,SAAS,SAAS,OAAO;AAC9B,gBAAc;AACdA,gBAAAA,MAAI,eAAe,SAAS,KAAK;AACnC;AAEO,SAAS,WAAW;AACvB,QAAM,aAAaA,cAAAA,MAAI,eAAe,OAAO;AAC7C,SAAO,eAAe;AAC1B;AAEO,SAAS,cAAc;AAC1B,gBAAc;AACdA,sBAAI,kBAAkB,OAAO;AACjC;AASA,IAAI,gBAAgB;AAEb,SAAS,WAAW,SAAS;AAClC,kBAAgB;AAChBA,gBAAAA,MAAI,eAAe,WAAW,OAAO;AACvC;AAEO,SAAS,aAAa;AACzB,QAAM,eAAeA,cAAAA,MAAI,eAAe,SAAS;AACjD,SAAO,iBAAiB;AAC5B;AAEO,SAAS,QAAQ,SAAO,IAAG;AACjC,MAAI;AAAA,IACH;AAAA,IACA,OAAK,CAAE;AAAA,IACP,SAAO;AAAA,IACP,SAAO,CAAE;AAAA,EACX,IAAK;AAEJ,QAAM,WAAS;AAGf,QAAM,QAAQ;AACd,MAAI,OAAO;AACP,WAAO,gBAAgB,GAAG,KAAK;AAAA,EAClC;AACD,SAAO,IAAI,QAAQ,CAAC,SAAQ,WAAS;AACpCA,kBAAAA,MAAI,QAAQ;AAAA,MACX;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA,SAAQ,SAAK;AACZ,YAAI,IAAI,eAAe,KAAK;AAC3B,cAAG,IAAI,QAAQ,IAAI,KAAK,SAAS,KAAI;AACpC,oBAAQ,IAAI,IAAI;AAAA,UACtB,OAAY;AACN,mBAAO,IAAI,IAAI;AAAA,UACf;AAAA,QACN,OAAW;AACN,iBAAO;AAAA,YACN,MAAM,IAAI;AAAA,YACV,KAAK,WAAW,IAAI,UAAU;AAAA,YAC9B,MAAM,IAAI;AAAA,UAChB,CAAM;AAAA,QACD;AAAA,MACD;AAAA,MACD,MAAK,SAAK;AACT,eAAO,GAAG;AAAA,MACV;AAAA,IACJ,CAAG;AAAA,EACH,CAAE;AACF;;;;;;;"}